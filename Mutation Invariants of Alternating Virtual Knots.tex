\documentclass[12pt]{report}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% General Packages
\usepackage{amsmath, amssymb, amsthm}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{geometry}
\usepackage{enumerate}

\usepackage[hidelinks]{hyperref}



%%% Font and Text Packages
\usepackage{newpxtext}
\usepackage{newpxmath}

\usepackage[dvipsnames]{xcolor}


%%% Graphics, Figure and Listing Packages
\usepackage{graphicx}
\usepackage{float}
\usepackage{calc}
\usepackage{caption}
\usepackage{subcaption}


%%% Epigraph
\usepackage{epigraph}


%%% Listings
\usepackage{listings}
\usepackage{lstfiracode}


%%% Bibliography Packages
\usepackage[style=alphabetic]{biblatex}
\bibliography{references}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Page Formatting Options
\geometry{left = 2.5cm}
\geometry{right = 2.5cm}
\geometry{top = 2.5cm}
\geometry{bottom = 2.5cm}

%%% Section and Chapter Titling Options

\titleformat{\chapter}[display]
	{\normalfont\bfseries\LARGE}
	{\chaptertitlename~\thechapter}
	{0pc}
	{{\color{black!30!white}\titlerule[2pt]}\vspace{0.8pc}\normalfont\Large}
  
\titleformat{name=\chapter, numberless}[display]
	{\normalfont\bfseries\LARGE}{}{1pc}
	{\normalfont\Large}
  
\titlespacing*{\chapter}{0pt}{30pt}{40pt}

\titleformat{\section}
	{\normalfont\bfseries\large}
	{\normalfont\bfseries\large{\thesection}}
	{1em}
	{}

%%% Hyperlink Formatting Options
\hypersetup{
    colorlinks,
    linkcolor={black},
    citecolor={blue!60!black},
    urlcolor={blue!80!black}
}

%%% Epigraph Options and Setup
\setlength\epigraphwidth{0.6\textwidth}
\setlength{\epigraphrule}{0pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Graphics and Figure Options
% Graphics path (necessary for .svg images).
\graphicspath{{graphics/}}
\counterwithout{figure}{chapter}

% Caption setup
\captionsetup{margin=1.5cm}


%%% Listings Options
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{codeback}{rgb}{0.95,0.95,0.92}
\lstset{
	language=Python,
	backgroundcolor=\color{codeback},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	style=FiraCodeStyle,   % Use predefined FiraCodeStyle
	basicstyle=\ttfamily,   % Use \ttfamily for source code listings
	numbers=left
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Personal Macros
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\T}{\mathbb{T}}
\renewcommand{\S}{\mathbb{S}}
\newcommand{\ip}[2]{\langle #1, #2 \rangle}
\newcommand{\inject}{\lhook\joinrel\longrightarrow}

\newcommand{\kob}{\operatorname{kob}}

\newcommand{\hash}{\ensuremath{\mathbin{\#}}}

%%% Drafting Macros
\newcommand{\notered}[1]{{\color{Red} \textbf{#1}}}
\newcommand{\notegreen}[1]{{\color{Green} \textbf{#1}}}
\newcommand{\noteblue}[1]{{\color{Blue} \textbf{#1}}}

%%% amsthm Options
\newtheorem*{theorem}{Theorem}
\newtheorem*{proposition}{Proposition}
\newtheorem*{conjecture}{Conjecture}
\newtheorem*{lemma}{Lemma}
\newtheorem*{corollary}{Corollary}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
	
%%% Make titlepage.

% Titlepage Options
\author{Damian Lin}
\title{Mutation Invariants of Alternating Virtual Knots}

\cleardoublepage \thispagestyle{empty}
\null \vfil
\begingroup
\LARGE \bfseries \centering
\openup \medskipamount
\thetitle \par \vspace{30pt}
\centering \mdseries \theauthor \par \bigskip
\endgroup
\vfil \vfil \vfil
\begin{center}
	An essay submitted in partial fulfilment of\\
	the requirements for the degree of\\
	Bachelor of Science/Bachelor of Advanced Studies (Honours)
	\vfil\vfil
	{\large Pure Mathematics\\[5pt]
		University of Sydney}\\
	\vskip6mm
	\includegraphics[width=25mm]{graphics/USY_MB1_CMYK_Stacked_Logo}
	\vfil
	\normalsize\today
\end{center}
\vfil
\cleardoublepage

\tableofcontents

\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}

\notegreen{Introduction...}

\notered{very draft}
In order to keep this text relatively self-contained, we begin in Chapter 1 with the study of knots, for without the bread and butter of knot theory, knot invariants. This provides some motivation for the rest of this chapter in which we slowly build our way up to a specific invariant of alternating knots, the lattice of integer flows of the Tait graph, closely following the work of Greene \cite{lattices-graphs-mutation}. We then look at the formulation given by Greene, the $d$-invariant and how that relates to Heegard-Floer homology and another formulation of the $d$-invariant. In Chapter 2, we examine virtual knots, a generalisation of knots with a several equivalent formulations that allows knots to have diagrams on an orientable surface of any genus. The aim of this is to extend this invariant to the virtual setting, and examine what properties it is able maintain in this new environment. We suspect the virtual $d$-invariant is less powerful than another invariant known as the Gordon-Litherland Linking Form, and we examine their relationship in Chapter $3$, and in Chapter $4$ we discuss how Gauss codes provide a way for computers to deal with knots. In Chapter $5$ we examine an algorithm to compute these invariants, and present a proof that indeed, the virtual $d$-invariant is not as strong as the Gordon-Litherland Linking Form, and therefore not a complete mutation invariant of alternating knots.

\chapter*{Acknowledgements}
\addcontentsline{toc}{chapter}{Acknowledgements}

Thanks to ...

We would like to thank Hans Boden for an insight into the proof of the proposition in Chapter 5.


\chapter{Knots and the Lattice of Integer Flows}
\epigraph{\itshape ``A knot!'' said Alice, ``oh, do let me help to undo it!''\\``I shall do nothing of the sort!'' said the mouse.}{--- Lewis Carroll, \textit{Alice's Adventures in Wonderland}}

\section{Knots and Knot Invariants}

We begin with a swift introduction to the rich and marvellous study of tangled-up pieces of string: the theory of knots. Despite being a complex and intricate field, any child can intuitively grasp the concept of a knot as a closed loop of string in space. To formalise this and remove any pathological examples that are inconsistent with this intuition, we define a \textit{knot} to be an injective embedding of the circle into $3$-space, $K: \S^{1} \inject \R^{3}$. The requirement that the embedding be injective ensures that the string does not intersect itself. Fig.~\ref{fig:knot-examples} gives a few example knots.

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/unknot.pdf_tex}
		\caption{Unknot or Trivial Knot, $0_{1}$}
		\label{fig:unknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil.pdf_tex}
		\caption{Trefoil Knot, $3_{1}$}
		\label{fig:trefoil}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/6-3_knot.pdf_tex}
		\caption{The knot $6_{3}$}
		\label{fig:6-3-knot}
	\end{subfigure}
	\caption{Some examples of knots, presented through knot diagrams. Their names in the Rolfsen knot table are also given.}
	\label{fig:knot-examples}
	\hspace*{\fill} 
\end{figure}

The example in Fig.~\ref{fig:unknot-twisted} shows a knot that can be `untwisted' to look like the example in Fig.~\ref{fig:unknot}. In general, we do not distinguish between knots if there is some way to deform one, without breaking the circle or passing it through itself, into the other. We say two knots $K_{1}$ and $K_{2}$ are \textit{equivalent} or equal if there is an \textit{ambient isotopy} from $K_{1}$ to $K_{2}$; that is, a continuous map
\[F: \R^{3} \times I \longrightarrow \R^{3}\]
such that at each $t \in I$, the corresponding $f_{t}: \R^{3} \longrightarrow \R^{3}$ is a homeomorphism of $\R^{3}$, and $f_{0}$ is the identity map on $\R^{3}$, while $f_{1} \circ K_{1} = K_{2}$.

Though a central objective of knot theory it to classify knots up to ambient isotopy, it can be hard to write down explicit ambient isotopies directly. Rather, we use other means to classify knots which will be the subject of the remainder of this section.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/unknot_twisted.pdf_tex}
		\caption{A less complicated diagram for the unknot.}
		\label{fig:unknot-twisted}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/unknot_goeritz.pdf_tex}
		\caption{A more complicated diagram for the unknot.}
		\label{fig:unknot-goertiz}
	\end{subfigure}
	\hspace*{\fill}
	\caption{It can be difficult to tell whether two diagrams represent the same knot. The diagram in (b) is from \cite{notes-on-knot-theory}.}
	\label{fig:more-unknots}
\end{figure}

Though we claimed that the objects in Fig.~\ref{fig:knot-examples} were knots, they are really projections of knots onto the plane with markings we call \textit{crossings} to make clear that some \textit{strand} of the knot passes over another strand. We refer to these objects as \textit{knot diagrams}. We consider diagrams equivalent up to planar isotopy as $4$-valent graphs. In other words, diagrams can just as well be thought of as combinatorial objects consisting of a list of crossings with labelled ends, and a a description of how these ends connect. So long as the ends are connected in a planar way, the exact path that connects them is unimportant.

Different diagrams can represent the same knot: for example, the diagrams in Fig.~\ref{fig:unknot} and Fig.~\ref{fig:unknot-twisted}, as the latter could be `untwisted' into the former. It is not always obvious when two diagrams represent the same knot. An example is Fig.~\ref{fig:unknot-goertiz}, yet another diagram for the unknot, but it may not be immediately obvious how this knot can be untangled. The unknot is not special here -- every knot has many diagrams, and there is no upper bound on the number of crossings, as we could continually add twists to an arc to create diagrams with arbitrarily many crossings for any knot. However, each knot does have a lower bound on the number of crossings any diagram representing it can have, which we call its \textit{crossing number}. For example, the crossing number of the unknot is $0$, and the crossing number of the Trefoil knot is $3$, and this lower bound is realised in the diagram in Fig.~\ref{fig:trefoil}.

Diagrams are easier to work with than embeddings, thanks to the following foundational theorem due to Alexander-Briggs  \cite{types-of-knotted-curves} and independently Kurt Reidemeister \cite{elementary-justification-knot-theory}.
\begin{theorem}(The Reidemeister Theorem)
Two knot diagrams $D_{1}$ and $D_{2}$ represent equivalent knots if and only if there is some sequence of finitely many moves of the types given in Fig.~\ref{fig:reidemeister_moves} that transform $D_{1}$ into $D_{2}$.
\end{theorem}

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/reidemeister_1.pdf_tex}
		\caption{\textit{R}I}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/reidemeister_2.pdf_tex}
		\caption{\textit{R}II}
	\end{subfigure}
	\hspace*{\fill}
	\\
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/reidemeister_3.pdf_tex}
		\caption{\textit{R}III}
	\end{subfigure}
	\hspace*{\fill}
	\caption{The Reidemeister moves.}
	\label{fig:reidemeister_moves}
\end{figure}


The early study of knot theory by pioneers such as P.G. Tait, C.N. Little and T. Kirkman involved trying to find, by hand, sequences of moves to show two knots were equivalent. And in hindsight they did remarkably well with so few tools. But Tait himself noted that it was impossible by these means alone to ever prove that two knots were distinct. The modern way we do this is by using knot invariants. If we define some map from knot diagrams to some other class of objects, perhaps a truth value, a polynomial, or a group, and show that none of the Reidemeister moves changes the value of this map, then we have a well-defined function on knots: a \textit{knot invariant}. This allows us to prove that two knots are different, for if they take on different values under some invariant, they must be distinct.

However, invariants are one-sided in nature. Taking different values can tell us that two knots are different, but two knots taking on the same value of some invariant doesn't necessitate that they be equivalent knots. Such an invariant -- one that is an injective function from the class of knots -- is called a \textit{complete} invariant, and while we now know of a zoo of different invariants, we have yet to find what is perhaps the Holy Grail of knot theory: a complete invariant that is also easy to compute.


\section{Connected Sums and Prime Knots}
In order to classify knots, it is helpful to be able to build large knot out of smaller ones, and vice-versa, decompose complicated knots into their simpler ``atomic'' pieces.

Given knots $K_{1}$ and $K_{2}$, we define the connected sum, $K_{1} \hash K_{2}$ as illustrated in Fig.~\ref{fig:connected-sum}. Take $K_{1}$ and $K_{2}$ and remove a small arc from each knot, then reconnect the two cut knots to form $K_{1} \hash K_{2}$.

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.5}
	\input{graphics/connected_sum.pdf_tex}
	\caption{Example of a connected sum with $K_{1} = 3_{1}$ and $K_{2} = 6_{3}$.}
	\label{fig:connected-sum}
\end{figure}


If $K_{1}$ and $K_{2}$ are oriented (equipped with a direction) then there is only one way to connect the cut ends in an orientation-preserving way. Otherwise there are two choices. This choice aside, $K_{1} \hash K_{2}$ is well-defined, as regardless which arc of $K_{1}$ we attached $K_{2}$ to, we could shrink $K_{2}$ to an arbitrarily small size, then pull it around $K_{1}$ to any desired spot, then re-enlarge it. Likewise, the arc chosen on $K_{2}$ does not matter, so the connect sum is independent of choice of arc. In fact, this operation is also associative and commutative \cite[Corollary 7.13]{knots}.

There is a corresponding definition of connected sum for knot diagrams, where the arcs to cut are chosen on the periphery of each diagram and connected in a planar way (without introducing additional crossings).

With this, we have a way of expressing more complicated knots in terms of less complicated knots. We call a knot \textit{prime} if there is no way to write it as the connected sum of non-trivial knots. The only exception is the unknot, which we define not to be prime.  Similarly, we call a knot \textit{composite} if there is a way to write it as the connected sum of at least two knots, none of which is the trivial knot. In this way, the prime knots and the connected sum are in analogy with the prime numbers and multiplication. There is even a unique decomposition theorem for knots, just as for prime numbers \cite[Thoerem 7.12]{knots}:

\begin{theorem}[Schubert's Theorem]
	Each non-trivial knot $K$ is a finite connected sum of prime knots and these factors are uniquely determined, up to permutation of the order of the connected sum. 
\end{theorem}

\section{Alternating Knots, Knot Mutation and the Tait Graph}
We call a knot diagram \textit{alternating} if, traversing the diagram, the crossings alternate under and over. For every diagram that is alternating, it is possible to construct a non-alternating diagram of an equivalent knot: one simply needs to apply a type \textit{R}I Reidemeister move appropriately to any strand of the knot: for example the alternating diagram of the Trefoil knot in Fig.~\ref{fig:trefoil} transforms into the non-alternating diagram in Fig.~\ref{fig:trefoil-nonalternating}. Hence we define an \textit{alternating knot} as a knot which can be represented by an alternating diagram. For low crossing-number, that is for knots that can be represented by diagrams with few crossings, many of the knots are alternating, but this trend quickly reverses as crossing number is increased.

An alternating knot diagram is \textit{reduced} if there are no nugatory crossings. A \textit{nugatory crossing} is a crossing for which there is a circle in the projection plane of the knot diagram which intersects the diagram transversely at that crossing, but nowhere else. Nugatory crossings are those which could be immediately undone to simplify the knot diagram. The diagram in Fig.~\ref{fig:trefoil} is a reduced alternating diagram, while the diagram in Fig.~\ref{fig:trefoil-nugatory} is alternating but not reduced.


\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.23}
		\input{graphics/trefoil_nonalternating.pdf_tex}
		\caption{A non-alternating diagram of the Trefoil knot.}
		\label{fig:trefoil-nonalternating}
	\end{subfigure}
	\hspace*{\fill} \hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.23}
		\input{graphics/trefoil_nugatory.pdf_tex}
		\caption{An alternating but not-reduced diagram of the Trefoil knot.}
		\label{fig:trefoil-nugatory}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{Diagrams of the Trefoil knot.}
	\label{fig:trefoil-diagrams}
\end{figure}

Alternating knots are of particular interest in knot theory, and they possess a number of interesting properties. Tait made a series of conjectures about alternating knots in his early attempts to tabulate knots. The most significant of these conjectures is known as the flyping conjecture, and it relates reduced alternating diagrams of the same alternating knot by moves known as flype moves.

A \textit{tangle} in a knot diagram is a region of the plane that is homeomorphic to a disc, such that the knot crosses the boundary of the disc exactly four times, as in Fig.~\ref{fig:kinoshita-terasaka-knot} and Fig.~\ref{fig:conway-knot}. A \textit{flype} move is a diagrammatic move that flips a tangle but does not alter the knot type, as in Fig.~\ref{fig:flype}. \notered{Does this preserve alternatingness? May not matter, but useful to include if true.} Tait's Flyping conjecture was proven by Menasco and Thistlethwaite in \cite[p. 166]{classification-alternating-links}:

\begin{theorem}[Flyping Theorem]
Any two reduced alternating diagrams, $D$ and $E$ of the same prime knot, are related by a sequence of flypes.
\end{theorem}

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.5}
	\input{graphics/flype.pdf_tex}
	\caption{A general flype move.}
	\label{fig:flype}
\end{figure}

This is a Reidemeister-like theorem for alternating knots in that is relates equivalence of diagrams to the existence of a sequence of moves between them.

Knot mutation is another way of constructing new knots from existing ones, preserving the alternating property. If we take a diagram, choose a tangle, and then perform a reflection (up to planar isotopy) of that tangle, either reflecting it left-right or up-down, or across one of the diagonals, the corresponding operation on the knot is known as \textit{mutation}, and the two knots are called \textit{mutants}. Mutants are some of the hardest knots to distinguish, as many of their invariants are the same. An example of this is the Conway the Kinoshita-Terasaka knots, given in Fig.~\ref{fig:kinoshita-terasaka-mutants}.

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.25}
		\input{graphics/kinoshita-terasaka.pdf_tex}
		\caption{The Kinoshita-Terasaka Knot}
		\label{fig:kinoshita-terasaka-knot}
	\end{subfigure}
	\hspace*{\fill} \hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.25}
		\input{graphics/conway.pdf_tex}
		\caption{The Conway Knot}
		\label{fig:conway-knot}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{The Kinoshita-Terasaka mutants. These are the two non-trivial knots of lowest crossing number that have trivial Alexander polynomial. The disk of mutation is marked. The projections used for these diagrams were taken from \cite[Fig.~2.32]{the-knot-book}.}
	\label{fig:kinoshita-terasaka-mutants}
\end{figure}

To a knot diagram, we associate two graphs known as the \textit{Tait graphs}, shown in Fig.~\ref{fig:tait-example} and explained as follows. We interpret the knot diagram as a tetravalent planar graph that divides the plane into regions. By an application of the Jordan curve theorem, it is possible to colour these regions two colours, black and white, such that adjacent regions are never the same colour. Such a colouring is called a \textit{checkerboard colouring}. Note that in a checkerboard colouring, regions that are diagonal to each other at crossings are necessarily the same colour.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil.pdf_tex}
		\caption{Trefoil Knot\dots}
		\label{fig:trefoil-blank}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil_checker.pdf_tex}
		\caption{\dots with a checkerboard colouring \dots}
		\label{fig:trefoil-checker}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil_checker_tait.pdf_tex}
		\caption{\dots and its Tait graph}
		\label{fig:trefoil-checker-tait}
	\end{subfigure}
	\hspace*{\fill}
	\caption{Producing the Tait graph(s) of the trefoil knot. \notered{Swap crossings!}}
	\label{fig:tait-example}
\end{figure}


In the checkerboard colouring of a diagram, the colouring around each crossing can look one of two ways. According to this, we call the crossings either Type $A$ or Type $B$. In an alternating diagram, all crossings will have the same type \cite[300]{spanning-tree-expansion-jones-polynomial}. The convention for alternating knots is to choose the checkerboard colouring such that all crossings are type $A$.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.28}
		\input{graphics/checkerboard_type_a.pdf_tex}
		\caption{Type $A$.}
		\label{fig:type-a}
	\end{subfigure}
	\hspace*{\fill} \hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.28}
		\input{graphics/checkerboard_type_b.pdf_tex}
		\caption{Type $B$.}
		\label{fig:type-b}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{Crossing Type}
	\label{fig:crossing-type}
\end{figure}


A checkerboard colouring, of a knot diagram specifies two not-necessarily orientable spanning surfaces for the knot: a spanning surface is a surface embedded in $\R^{3}$ whose boundary is the knot. These spanning surfaces are obtained by attaching disks for each coloured region by twisted bands for each crossing, where the twisting direction is specified by the type of the crossing. The convention that all crossings be of type $A$ corresponds with the convention that the black surface be positive definite with respect to the linking form on its first homology. This will be explained further in Chapter 3.

To construct the black Tait graph $G_{B}(D)$, we place a vertex in every black region of the plane. For each crossing we draw an edge between the vertices corresponding to the black region on either side of the crossing, obtaining a planar graph, potentially with multiple edges. The white Tait graph $G_{W}(D)$ is constructed similarly from the vertices corresponding to white regions.

Either of these graphs, along with their plane embeddings retain enough information to construct the other. The \textit{planar dual} of $G$, $G^{*}$, is the graph obtained by replacing every face in the plane embedding of $G$ with a vertex, and every edge in $G$ that separates two faces becoming and edge between the corresponding vertices in $G^{*}$. It can be easily seen from the way Tait graphs are constructed in Fig.~\ref{fig:tait-example} that the two Tait graphs are planar duals: $G_{B}(D)^{*} = G_{W}(D)$ and $G_{W}(D)^{*} = G_{B}(D)$. Because both planar graphs can be constructed from a each other, we sometimes refer to either one as \textit{the} Tait graph of a knot. Later we will examine the more general class of knots in thickened surfaces, for which this duality breaks down, and we will need both Tait graphs.

If we have the Tait graph of an alternating diagram of a knot, we can reconstruct the knot diagram by placing a crossing on every edge of the Tait graph, as seen in Fig.~\ref{fig:trefoil-tait-with-crossings}. Connecting up the crossings by strands along the Tait graph, as in Fig.~\ref{fig:trefoil-resconstructed},	 reconstructs the knot diagram, up to planar isotopy.

\begin{figure}[h]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/trefoil_reconstruct_crossings.pdf_tex}
		\caption{Draw crossings on edges.}
		\label{fig:trefoil-tait-with-crossings}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/trefoil_reconstructed.pdf_tex}
		\caption{Connect the crossings.}
		\label{fig:trefoil-resconstructed}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil.pdf_tex}
		\caption{The reconstructed trefoil.}
		\label{fig:trefoil-resconstructed-isotopy}
	\end{subfigure}
	\hspace*{\fill}
	\caption{Reconstructing a knot diagram from its Tait graph.}
	\label{fig:tait-reconstruction-example}
\end{figure}

\section{The Lattice of Integer Flows}

For the rest of this chapter, we introduce the lattice of integer flows of a graph, then largely following \cite{lattices-graphs-mutation}, we show that the lattice of integer flows of the Tait graph is a complete mutation invariant of alternating knots. This means that it is both an invariant of alternating knots, and takes the same value on alternating knots if and only if they are mutants. We then talk about the equivalent formulation given in \cite{lattices-graphs-mutation} as the $d$-invariant.

A \textit{lattice} is a finitely generated abelian group $L$, equipped with an inner product 
\({\ip{\cdot}{\cdot}: L \times L \longrightarrow \R}\). All lattices in this text will be \textit{integral lattices}, meaning the inner product's image is contained within $\Z$. An \textit{isomorphism of lattices} is a bijection $\psi: L_{1} \longrightarrow L_{2}$ that preserves the inner product, that is, ${\ip{x}{y} = \ip{\psi(x)}{\psi(y)}}$ for all $x, y \in L$.

Let $G = (E, V)$ be a finite, connected graph (in which loops and multiple edges are allowed) with vertex set $V$ and edge set $E$. In particular, $G$ is a 1-dimensional CW-complex with boundary map $\partial: C_{1}(G) \longrightarrow C_{0}(G)$. In the edge basis of $C_{1}(G)$ and vertex basis of $C_{0}(G)$, this is a map $\Z^{E} \longrightarrow \Z^{V}$, and is represented by the $|V|\times|E|$ incidence matrix $D$ with entries given by
\[D_{ij} = \begin{cases}
	+1 & \text{if $e_{i}$ is oriented into $v_{j}$,}   \\
	-1 & \text{if $e_{i}$ is oriented out of $v_{j}$,} \\
	0  & \text{if $e_{i}$ is a loop at $v_{j}$ or is not incident to $v_{j}$.}
\end{cases}\]

The \textit{lattice of integer flows} of $G$ is the free abelian group $\Lambda(G) = \ker \partial$, along with the inner product induced by the Euclidean inner product on $\Z^{E}$. Equivalently, $\Lambda(G)$ is the first homology group of $G$, with inner products taken in $C_{1}(G)$. While the lattice $\Lambda(G)$ may depend on the orientation of the edges in $G$, its isomorphism class does not, as the isomorphism class of the homology group is independent of orientation, and the Euclidean inner product is preserved by sending an edge to its negation: $\ip{e_{i}}{e_{i}} =  \ip{-e_{i}}{-e_{i}} = 1$, and $\ip{e_{i}}{e_{j}} = \ip{-e_{i}}{e_{j}} = 0$ for $i \neq j$.

As an example, let $D$ be the diagram of the Trefoil knot given in Fig.~\ref{fig:tait-example} the Tait graphs of the trefoil knot   are shown in Fig.~\ref{fig:trefoil-abstract-tait}. We compute the lattice of integer flows of each of these graphs, $\Lambda(G_{B}(D))$ and $\Lambda(G_W(D))$. Rather than use this cumbersome notation, we shorten this to $\Lambda_{W}(D)$ or $\Lambda_{B}(D)$ for the lattice of integer flows of the Tait graph corresponding to the white/black regions, respectively. We orient the graphs arbitrarily to compute the lattice of integer flows, but as we will see the invariant produced is independent of this choice. We start with the more typical lattice of integer flows: that of the Tait graph corresponding to the white region (red in Fig.~\ref{fig:trefoil-abstract-tait}). There are two independent cycles, $-f_{1} + f_{2}$ and $-f_{2} + f_{3}$, so $\Lambda_{B}(3_{1})$ is generated as
\[\Lambda_{B}(D) = \langle -f_{1} + f_{2}, -f_{2} + f_{3} \rangle\,.\]
We are taking inner products in $\Z^{E}$ (that is, in the basis {$(f_{1}, f_{2}, f_{3})$}, so if $x$ and $y$ are coordinate vectors for $u$, and $v$, of two elements of $\Lambda_{B}(D)$ expressed in the basis $(-f_{1} + f_{2}, -f_{2} + f_{3})$, then
\[\langle u, v \rangle = x^{\top}\begin{bmatrix}
	2  & -1 \\
	-1 & 2
\end{bmatrix}y\,.\]
We call this matrix the \textit{pairing matrix} of the lattice $\Lambda_{B}(D)$ with respect to the basis ${(-f_{1} + f_{2}, -f_{2} + f_{3})}$.

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.4}
	\input{graphics/trefoil_abstract_tait.pdf_tex}
	\caption{The Tait graphs $G_{B}(D)$ and $G_{W}(D)$.}
	\label{fig:trefoil-abstract-tait}
\end{figure}

The pairing matrix of a lattice completely describes the lattice, however the pairing matrix is not completely determined by the lattice. Instead, the lattice only determines a pairing matrix up to unimodular congruence: two matrices $P$ and $P'$ are \textit{unimodular congruent} if there exists a matrix $A$ with $\det(A) = 1$, such that $P = A^{\top}P'A$. If $P$ is a pairing matrix of a lattice with respect to the basis $\mathcal{B}$ (with basis matrix $B$), and $P'$ is unimodular congruent to $P$ as above, then:
\begin{align*}
	\langle u, v \rangle & = [u]_{\mathcal{B}}^{\top} P [v]_{\mathcal{B}}                    \\
	                     & = B[u]_{\mathcal{E}}^{\top} P B[v]_{\mathcal{E}}                  \\
	                     & = B[u]_{\mathcal{E}}^{\top} A^{\top} P' A B[v]_{\mathcal{E}}      \\
	                     & = \left( AB[u]_{\mathcal{E}} \right)^{\top} P' AB[v]_{\mathcal{E}} \\
	                     & = \left( [u]_{\mathcal{AB}} \right)^{\top} P' [v]_{\mathcal{AB}}\,,
\end{align*}
so $P'$ is also a pairing matrix of the lattice with respect to the basis whose basis matrix is $AB$.


Continuing with our example, there is a single independent cycle in $G_{W}(D)$, it being $e_{1} + e_{2} + e_{3}$. Hence the pairing matrix of $\Lambda_{W}(D)$ with respect to $( e_{1} + e_{2} + e_{3})$ is $P = [3]$.

Since the 1970's, many graph theorists have studied exactly how much information about the graph $G$ is retained by $\Lambda(G)$ \parencite{lattice-of-flows-cuts, torelli-for-graphs-tropical-curves, lattice-of-flows-regular-matroid}. In the next paragraph we see that some information about $G$ is lost.

We call and edge $e$ of a graph $G$ a \textit{bridge} if the removal of $G$ from $e$ disconnects $G$, and we say a graph $G$ is \textit{$2$-edge-connected} if $G$ has no bridges. The lattice of integer flows of $G$ is blind to its bridges. We define $G_{\bullet}$ as $G$ with its bridges contracted: that is, for each bridge $e$, we remove $e$ and identify the adjacent vertices, then $\Lambda(G_{\bullet}) = \Lambda(G)$. This is because the cycles of $G$, and therefore the homology of $G$, do not see bridges.

A \textit{$2$-isomorphism} between two graphs $G = (E, V)$ and $G' = (E', V')$ is a bijection \({\psi: E \longrightarrow E'}\) which preserves cycles, i.e. $\partial(e_{i} + \cdots + e_{j}) = 0$ if and only if $\partial\left(\psi(e_{i}) + \cdots + \psi(e_{j})\right) = 0$. It is well established that $\Lambda(G)$ is a $2$-isomorphism invariant \parencite{lattice-of-flows-cuts}. Recent work by Su-Wagner and Caporaso-Viviani have also shown that for $2$-edge-connected graphs, $\Lambda(G)$ is a complete $2$-isomorphism invariant \cites[Theorem 3.1.1]{torelli-for-graphs-tropical-curves}[Theorem 1]{lattice-of-flows-regular-matroid}. This is stated in the following theorem, which derives its name from a similar result in the context of algebraic geometry.


\begin{theorem}[Torelli Theorem for Graphs]
For two $2$-edge-connected graphs $G$ and $G'$, $\Lambda(G) \cong \Lambda(G')$ if and only if $G$ and $G'$ are $2$-isomorphic.
\end{theorem}

The notion of $2$-isomorphism is completely characterised in the following way. Two graphs $G$ and $G'$ are related by a \textit{Whitney flip} if it is possible to find two disjoint graphs $\Gamma_{1}$, with distinguished vertices $u_{1}$ and $v_{1}$ and $\Gamma_{2}$ with distinguished vertices $u_{2}$ and $v_{2}$, such that the identifications $u_{1} = u_{2} = u$ and $v_{1} = v_{2} = v$ form $G$, and the identifications $u_{1} = v_{2} = u'$ and $v_{1} = u_{2} = v'$ form $G'$. An example of graphs related by a Whitney flip is given in Fig.~\ref{fig:whitney_flip}.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.5}
	\input{graphics/whitney_flip.pdf_tex}
	
	\caption{An example of a Whitney flip.}
	\label{fig:whitney_flip}
\end{figure}

It is clear that sequences of Whitney flips only ever transform graphs within their $2$-isomorphism class, as cycles map to cycles. From \cite{2-isomorphic-graphs}, we have the important converse; a Reidemeister-like theorem for $2$-isomorphic graphs.

\begin{theorem}[Whitney's Theorem]
Two graphs $G$ and $G'$ are $2$-isomorphic if-and-only-if there is a sequence of Whitney flips relating $G$ to $G'$.
\end{theorem}

Our aim now is to show that $\Lambda_{B}(D)$ and $\Lambda_{W}(D)$ are invariants of alternating knots.  In particular, we draw attention to the author's original geometric proof of this fact, in contrast with the topological arguments given in \cite{lattices-graphs-mutation}.

The plan is to use the flyping theorem to relate alternating diagrams of the same knot by sequences of flypes.  We will discover that these translate into sequences of Whitney flips on the Tait graph \notered{[should probably make this a lemma right?]}. Whitney's theorem and the Torelli theorem for graphs will then relate the lattices of integer flows of the Tait graph of each diagram. The main complication will be that the flyping theorem only relates alternating diagrams of prime knots. We begin with some lemmas that help us remedy this situation.


The first lemma is a theorem due to Menasco \cite{closed-incompressible-surfaces}, which has also been aptly paraphrased as ``an alternating knot is prime if and only if it looks prime'' \cite{the-first-two-million-knots}:

\begin{lemma}[Menasco]
	Suppose $K$ is a knot that has an alternating diagram $D$. Then $K$ is a prime knot if and only if $D$ is a prime diagram.
\end{lemma}

The second lemma is a textbook fact about alternating knots. \notered{Will this suffice or should I prove it?}

\begin{lemma}
	Let $K = K_{1} \hash K_{2} \hash \cdots \hash K_{n}$. Then $K$ is alternating if and only if for all $i \in \{0, \cdots, n\}$, $K_{i}$ is alternating.
\end{lemma}

The third lemma is a theorem of Kauffman, Murasugi and Thistlethwaite, all separately in 1987 \cite{state-models-jones-polynomial, jones-polynomials-classical-conjectures, spanning-tree-expansion-jones-polynomial}.

\begin{lemma}[Kauffman, Murasugi, Thistlethwaite]
	A reduced diagram of a prime alternating knot is alternating.
\end{lemma}

We this, we prove that the lattice of integer flows of the Tait graph is an invariant of alternating knots.

\begin{theorem}
	Let $K$ be alternating, and let $D$, $E$ be alternating diagrams for $K$. Then $\Lambda_{B}(D) \cong \Lambda_{B}(E)$.
\end{theorem}

\begin{proof}
All non-reduced alternating diagrams of $K$ reduce to an alternating diagram for $K$ without changing the lattice of integer flows of their Tait graphs, so we may assume that $D$ and $E$ are alternating reduced diagrams for $K$. 

First we consider the case where $K$ is a prime knot. By the flyping theorem, $D$ and $E$ are related by a sequence of flypes. As flypes induce Whitney flips of the Tait graph, and by Whitney's theorem, $G_{B}(D)$ and $G_{B}(E)$ are $2$-isomorphic. As reduced diagrams of alternating knots are $2$-edge-connected, the Torelli Theorem for Graphs applies, and so $\Lambda_{B}(D) \cong \Lambda_{B}(E)$.

We also consider where $K$ is composite. By Schubert's Theorem,
\[K = K_{1}  \hash K_{2}  \hash \cdots  \hash K_{n}\,,\]
with each $K_{i}$ prime for $i \in \{1, \cdots, n\}$, and this decomposition is unique up to permutation. By the first lemma, $K$ is composite, so $D$ is a composite diagram:
\[D = D_{1}  \hash D_{2}  \hash \cdots  \hash D_{m}\,,\]
for some $m > 1$. We may assume that each $D_{i}$ is a prime diagram, otherwise, we could further factor the connected sum. By the second lemma, each $[D_{i}]$ (by this notation we mean the knot corresponding to the diagram $D_{i}$) is an alternating knot \notered{[why?]}. Furthermore, again applying Menasco's theorem, we see that the knot $[D_{i}]$ represented by each $D_{i}$ is prime. We now have two prime decompositions for $K$:
\[K = K_{1}  \hash K_{2}  \hash \cdots  \hash K_{n}\,,\]
and
\[K = [D_{1}]  \hash [D_{2}]  \hash \cdots  \hash [D_{m}]\,.\]
By Schubert's theorem, and by relabelling the $D_{i}$, we have that $m = n$ and $[D_{i}] = K_{i}$
for each $i \in \{0, \cdots, n\}$. Without loss of generality, \[E = E_{1} \hash E_{2} \hash \cdots \hash E_{n}\,,\] and the same is true for the $E_{i}$, hence
$[D_{i}] = [E_{i}]$
for all $i \in \{1, \cdots, n\}$.

We have that each $[D_{i}]$ or $[E_{i}]$ is a prime alternating knot, and each $D_{i}$ or $E_{i}$ is a reduced diagram, as $D$ and $E$ were reduced. So the theorem of Kauffman, Murasugi and Thistlethwaite gives that each $D_{i}$ and $E_{i}$ is an alternating diagram. For each $D_{i}$ and $E_{i}$, we now have the hypothesis of the first case satisfied: we have two alternating, reduced diagrams for the same prime alternating knot, so $\Lambda_{B}(D_{i}) \cong \Lambda_{B}(E_{i})$ for all $i \in \{0, \cdots, n\}$.

Finally, since the Tait graph of a connected sum of knots is graph formed by identifying a vertex of each Tait graphs of the factor knots,
\begin{align*}
	\Lambda_{B}(D) & = \Lambda_{B}(D_{1}) \oplus \Lambda_{B}(D_{2}) \oplus \cdots \oplus \Lambda_{B}(D_{n}) \\
	               & = \Lambda_{B}(E_{1}) \oplus \Lambda_{B}(E_{2}) \oplus \cdots \oplus \Lambda_{B}(E_{n})\\
	               & = \Lambda_{B}(E)\,. \qedhere \\ 
\end{align*}
\end{proof}

This shows that $\Lambda_{B}(D)$ and $\Lambda_{B}(D)$ is a well-defined function on alternating knots, and henceforth we may write $\Lambda_{B}(K)$ so long as $K$ is alternating.

By the same argument $\Lambda_{W}(D)$ is also an invariant of alternating knots. However combining these two invariants retains no information: they are equivalent invariants to each other.

\begin{theorem}
For an alternating knots $K_{1}$ and $K_{2}$, $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$ if and only if $\Lambda_{W}(K_{1}) \cong \Lambda_{W}(K_{2})$.
\end{theorem}

\begin{proof}
\notered{Lattice of integer flows/cuts duality?}
\end{proof}

It only remains to show that $\Lambda_{B}(K)$ is a complete invariant up to mutation. The following lemma examines the effect of mutation on the Tait graph \cite[Lemma 4.5]{lattices-graphs-mutation}:

\begin{lemma}[Greene]
Depending on the tangle to be mutated, a mutation of $D$ either:
\begin{itemize}
\item affects only the planar embedding of the Tait graph, leaving its graph structure unchanged, or
\item induces a Whitney flip in the Tait graph.
\end{itemize}
Conversely, a Whitney flip in the Tait graph induces a mutation in $D$.
\end{lemma}

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.65}
	\input{graphics/mutation_whitney_flip.pdf_tex}
	
	\caption{A mutation may induce a Whitney flip. Figure modified from \cite[Fig.~2]{lattices-graphs-mutation}.}
	\label{fig:mutation-whitney-flip}
\end{figure}

A single case in the proof of this lemma can be found in Fig.~\ref{fig:mutation-whitney-flip}. For the full proof including remaining cases consult \cite[Fig. 2-4]{lattices-graphs-mutation}. Greene uses this lemma to prove that the lattice of integer flows of the Tait graph is a complete mutation invariant of alternating knots \cite[Proposition 4.4]{lattices-graphs-mutation}.

\begin{theorem}[Greene]
Let $K_{1}$ and $K_{2}$ be alternating knots. Then $K_{1}$ and $K_{2}$ are mutants if and only if  $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$.
\end{theorem}

\begin{proof}
Let $K_{1}$ and $K_{2}$ be alternating virtual knots. For the forward implication, suppose that $K_{1}$ and $K_{2}$ are mutants, so there is a sequence of mutations from a diagram of $K_{1}$ to a diagram of $K_{2}$. By the lemma above, their Tait graphs $G_{B}(K_{1})$ and $G_{B}(K_{2})$  are related by Whitney flips. By Whitney's theorem, each of these pairs of graphs are $2$-isomorphic. Since $\Lambda_{B}(G)$ is a $2$-isomorphism invariant, $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$.

For the reverse implication, take two alternating knots such that $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$. We may assume them to be reduced, as reduction of a knot does not alter the lattice of integer flows of its Tait graphs. As the knots are reduced, their Tait graphs $2$-edge-connected. So, by the Torelli theorem for graphs, $G_{B}(K_{1})$ and $G_{B}(K_{2})$ are $2$-isomorphic. By Whitney's theorem, there is a sequence of Whitney flips between each of these pairs, which by the lemma above corresponds to a sequence of mutations between $K_{1}$ and $K_{2}$, so they are mutants.
\end{proof}

\section{\notegreen{Heegaard-Floer Homology and the $d$-invariant}}
\notegreen{Show that can be compressed into the $d$-invariant, and nothing is lost.}

\notegreen{Questions:
\begin{itemize}
\item Why are the lattice of integer flows and the $d$-invariant equivalent again?
\end{itemize}
}

Heegaard-Floer homology is a homology theory introduced in a series of papers by Peter Ozsv\'ath and Zoltan Sz\'abo at the turn of the 21st century. The theory consists of a powerful set of topological invariants that fit within a topological quantum field theory. It has proven to be incredibly useful in low-dimensional topology.

The lattice of integer flows of the Tait graph of a knot can be reduced into an equivalent, more compact invariant. This so-called the $d$-invariant of the lattice of integer flows of its Tait graph (which we will refer to as the `lattice-theoretic' $d$-invariant) is constructed in \cite{lattices-graphs-mutation}, and shown to be equivalent to a construction from Heegaard-Floer' homology: the $d$-invariant of the of the double branched-cover of of the knot (which we will refer to as the `Heegaard-Floer' $d$-invariant). 
\notered{Below we briefly review the construction of the $d$-onvariant from the l.oif. Thheconnect with HF homology. We will stick to the lattice of loif.}

In particular, Greene shows that instead of considering the whole lattice $\Lambda_{B}(K)$, it suffices to look at a particular coset of the dual lattice called the \textit{characteristic coset}:
\[\operatorname{Char} \Lambda = \left\{ \chi \in \Lambda^{*} \ \Big|\  \langle\chi,\lambda\rangle \equiv \langle\lambda,\lambda\rangle \pmod 2\  \forall \lambda \in \Lambda \right\}\,.\]
The $d$-invariant is a scaled function that takes an element of the quotient $(\operatorname{Char} \Lambda_{B}(K)) / (2 \Lambda_{B}(K))$ to the norm of its minimal-norm representative. Greene shows that this reduction is equivalent to the while lattice of integer flows by lattice-gluing techniques.

\notered{We don't talk much more about the $d$-invariant because the lattice of integer flows is much nicer.}

\chapter{Virtual Knots}

\epigraph{\itshape I thought this was the end\\But no my friends, this is when\\We get to do it all again...}{--- The Muppets}
\epigraph{\itshape ...and now it's virtual insanity.}{--- Jamiroquai}


We now introduce the exciting and relatively new theory of virtual knots. Virtual knots are a generalisation of knots, and there are many different equivalent formulations of them. We start with the most geometric of the formulations, but we also present a combinatorial and computational definition later.


\section{Knots in Thickened Surfaces under Stable Equivalence}

In this section we will largely follow the work of Kuperberg \cite{what-is-a-virtual-link} and Carter-Kamada-Saito \cite{stable-equivalence-virtual-cobordisms} and give the geometric definition of virtual knots as knots in thickened surfaces.

\textit{Classical} knots, a term which refers specifically to the kind of knots we have introduced prior to this chapter, have diagrams in the plane, $\R^{2}$, but really they have an extra dimension of `thickness', encoded in the diagram by the under- and over- crossings. Hence we think of knots as embeddings in $\R^{3}$. However we didn't really need a whole $\R$'s worth of extra space. We could easily think of classical knots as living in a thickened plane, $\R^{2} \times I$ where $I$ is the unit interval $[0, 1]$. Thinking of knots as embeddings in $\R^{2} \times I$, it becomes natural to ask: what if we replace the plane by another surface; can we have diagrams on other surfaces $\Sigma$ and therefore knots in \textit{thickened surfaces} $\Sigma \times I$? The answer to these questions is yes, and virtual knots are one such generalisation.

In the context of virtual knots, all surfaces of relevance are closed and orientable, with the exception of the plane. However, knots diagrams on the plane are equivalent to knot diagrams on the sphere. The only extra move allowed by this one-point compactification is that a strand on one side of a knot diagram can be taken over to the other \notered{[figure]} by isotopy of moving it around the back side of the sphere. However this was already allowed on the plane by a sequence of R\textit{III} moves.  The classification theorem for compact, orientable surfaces is the following.

\begin{theorem}[Classification of compact, orientable surfaces]
Each connected component of a compact, orientable surface is homeomorphic to:
\begin{itemize}
	\item the sphere, $\S^{2}$, (which we identify with the plane by the discussion above), or
	\item a connected sum of $g$ tori, $g\T^{2}$, for $g \geq 1$.
\end{itemize}
\end{theorem}
Hence there is a bijection between connected components of compact, orientable surfaces given by the \textit{genus}, $g$ of the surface, the number of handles.

A \textit{surface knot diagram} on $\Sigma$ is the analogue of a classical knot diagram, but drawn on a general closed, oriented, connected surface, $\Sigma$ no longer necessarily the plane. To represent diagrams in this section we use the letter $P$, for `projection', another common word for `diagram', as $D$ will be reserved for disks. The equivalence relation on surface knot diagrams is given by the Reidemeister moves and surface isotopy (the surface-analogue of planar isotopy) on $\Sigma$.

Instead of drawing surface knot diagrams directly on compact orientable surfaces, for genus $g \geq 1$, we often draw on the gluing diagrams of those surfaces. From a textbook theorem of algebraic topology \parencite{algebraic-topology}, the compact orientable surface of genus $g$ is obtained from the $4g$-gon by gluing around the polygon with the pattern $aba^{-1}b^{-1}$,~$cdc^{-1}d^{-1}$,~$\cdots$ continuing on for $g$ iterations, or until all edges have been glued. Fig.~\ref{fig:surface-knot-diagram-examples} contains examples of this.
\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.26}
		\input{graphics/unknot_on_surface.pdf_tex}
		\caption{A surface knot diagram on $\Sigma = \T^{2}$}
		\label{fig:torus-unknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.26}
		\input{graphics/3-7_vknot.pdf_tex}
		\caption{A more complicated surface knot diagram on $\Sigma = \T^{2}$}
		\label{fig:torus-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.24}
		\input{graphics/6-90101_vknot_small.pdf_tex}
		\caption{A surface knot diagram on $\Sigma = 2\T^{2}$}
		\label{fig:2torus-vknot}
	\end{subfigure}
	\caption{Some examples of surface knot diagrams. Note that classical knot diagrams would also be examples with $\Sigma = S^{2}$.}
	\label{fig:surface-knot-diagram-examples}
	\hspace*{\fill} 
\end{figure}

We can define knots on thickened surfaces so that they relate to surface knot diagrams, in the same way knots and knot diagrams are related in the classical context. A \textit{knot in a thickened surface} $\Sigma \times I$ is an embedding $K:S^{1} \inject \Sigma \times I$ up to ambient isotopy in $\Sigma \times I$. We denote a knot $K$ in thickened surface $\Sigma \times I$ as $(K, \Sigma)$.

We say a surface knot diagram is \textit{cellularly embedded} if $\Sigma \smallsetminus P$ is a union of disks. Being cellularly embedded is a way to check that a knot `fully utilises' the surface it is drawn on, in the following sense. Observe that in the surface knot diagrams in Fig.~\ref{fig:torus-vknot} and Fig.~\ref{fig:2torus-vknot} are cellularly embedded, and they surface knot diagrams could not be drawn on a surface of lower genus. If, for example, one was to try draw the surface knot diagram in Fig.~\ref{fig:torus-vknot} on the plane, connecting the two pairs of loose ends on the left and right side of the diagram would block the pairs of loose ends on the top and bottom from being connected without introducing extra crossings and changing the knot. In contrast, the surface knot diagram in Fig.\ref{fig:torus-unknot} could be drawn on the plane/sphere, however we don't yet have a notion of equivalence for surface knot diagrams (or knots in thickened surfaces) that live on surfaces of different genus. This example motivates the definition of virtual knots to come. Note that while a knot having a non-cellularly-embedded diagram could be drawn on a surface of lower genus, the converse does not hold: a knot that is cellularly embedded might still be able to be drawn on a diagram of lower genus, such as in Fig.~\ref{fig:cellular-embedding-tricky} \notered{make this clearer}.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.56}
	\input{graphics/torus_unknot_tricky.pdf_tex}
	
	\caption{An example of surface knot diagram which transforms to a not-cellularly-embedded diagram only after some Reidemeister moves. The single face in the final diagram contains a non-homologically-trivial cycle, marked in red, and hence is not contractible (a disk).}
	\label{fig:cellular-embedding-tricky}
\end{figure}

To define virtual knots we take knots in thickened surfaces of any genus and quotient by the equivalence relation of stable equivalence, defined based on the following two operations. We give these definitions on the level of surface knot diagrams, but note that they generalise to knots in thickened surfaces by accounting for the extra factor of $I$. The operation of \textit{stabilisation} consists of finding two disks $D_{1}$ and $D_{2}$ in $\Sigma$ that do not intersect $P$. We then remove $D_{1}$ and $D_{2}$ from $\Sigma$ and glue a handle whose boundary is $D_{1} \cup D_{2}$. Intuitively, stabilisation is `adding a handle' to $\Sigma$, and any newly added handle does not interact with $P$. The reverse operation \textit{destabilisation} removes a handle. Performing this operation, we take a cylinder $Y$ that does not intersect $P$, and such that the circle that $Y$ deformation-retracts to is not null-homologous, removes it, and cap both resulting boundary circles. The point of stable equivalence is to identify two knot diagrams $P_{1}$ and $P_{2}$ that would otherwise be identical, except for living on surfaces $\Sigma_{1}$ and $\Sigma_{2}$ of different genus as in the example above.

Hence we define a \textit{virtual knot} as an equivalence class of knots on thickened surfaces under stable equivalence. Two surface knot diagrams represent the same virtual knot if there is some sequence of Reidemeister moves and stabilisation/destabilisation moves from one diagram to the other.

The \textit{virtual genus} $g_{v}$ of a virtual knot is defined as the minimum genus of all surface knot diagrams for that virtual knot. The virtual knots with virtual genus $g_{v} = 0$ correspond to the classical knots, and the virtual knots with virtual genus $g_{v} < 0$ are \textit{strictly} virtual. The virtual knots in Fig.~\ref{fig:torus-vknot}~and~\ref{fig:2torus-vknot} are examples of strictly virtual knots.

An important question to ask is whether classical knot theory embeds faithfully into virtual knot theory: are there distinct classical knots which, when considered as virtual knots are rendered equivalent by stable equivalence? A uniqueness result of Kuperberg dispels this possibility and gives the even stronger result that we \textit{never} need to go `up' in genus to check whether virtual knots are equivalent.

\begin{theorem}[Kuperberg's Theorem]
If $K$ and $J$ are two minimal genus representatives of the same virtual knot of virtual genus $v_{g}$, then they are equivalent as knots in thickened surfaces of genus $v_{g}$.
\end{theorem}

However, as was illustrated in Fig.~\ref{fig:cellular-embedding-tricky}, the virtual genus of a virtual knot is not necessarily obvious, and furthermore, there is no known algorithm to compute the it. However the following theorem from \cite{parity-and-projection}, does allow some progress for low crossing number:
\begin{theorem}[Manturov]
	If a diagram of a knot $K$ in a thickened surface $\Sigma \times I$ contains the minimal number of crossings across all diagrams in thickened surfaces, then $\Sigma$ is the minimal genus surface that can support $K$. That is, the genus of $\Sigma$ is the knot's virtual genus.
\end{theorem}
In combination with Kuperberg's theorem, this says we also never need to go `up' in genus to reduce crossing number. It suffices to reduce the genus as much as possible, and then perform Reidemeister moves.


\section{Knots with Virtual Crossings}

We take a quick detour to relate knots in thickened surfaces modulo stabilisation to an equivalent definition of virtual knots. The original formulation of virtual knots (and their discovery) is due to Kauffman in 1996 \cite{virtual-knot-theory}. This formulation can be related to the formulation of equivalence classes of diagrams on $\Sigma$ by projecting the surface $\Sigma$ the onto the plane. Doing this creates two types of crossings. Those that did actually come from a crossing on $\Sigma$, we call \textit{classical crossings}, and they have the usual over- and under- strands as determined by the projection. Those that did not exist on $\Sigma$ but rather are an artefact of the projection we call \textit{virtual crossings}. For strictly virtual knots these virtual crossings will be necessary, as the $4$-valent graph that the knot represents is not planar.

\begin{figure}[h!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_1.pdf_tex}
		\caption{\textit{VR}I}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_2.pdf_tex}
		\caption{\textit{VR}II}
	\end{subfigure}
	\hspace*{\fill}
	\\
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_3.pdf_tex}
		\caption{\textit{VR}III}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_4.pdf_tex}
		\caption{\textit{VR}IV}
	\end{subfigure}
	\hspace*{\fill}
	\caption{The four additional virtual Reidemeister moves.}
	\label{fig:virtual-reidemeister-moves}
\end{figure}

The relevant equivalence relation on diagrams with virtual crossings are not hard to deduce. We have the three Reidemeister moves which still hold between classical crossings, three corresponding moves similar to the Reidemeister moves but with all classical crossings replaced by virtual crossings, and finally a `triangle move' that moves a `virtual strand' through a crossing.

Invariants can be defined for virtual knots as well. This allows for the tabulation of virtual knots, such as the table by Jeremy Greene \cite{virtual-knot-table}. Green achieved this by computing all possible virtual knot diagrams up to $6$ crossings, determining which are equivalent via virtual Reidemeister moves, and then computing enough invariants distinguish all of these knots. 

Applying this Manturov's theorem to the classification of virtual knot diagrams up to $6$ crossings by Jeremy Green \cite{virtual-knot-table} we can determine the virtual genus of virtual knots up to $6$ crossings. We use the notation for virtual knots given in this tabulation. More about how virtual knots can be encoded for computation, leading to yet another definition of virtual knots will be given in Chapters 4 and 5.


\section{Annular Connected Sums and Prime Virtual Knots}
Having introduced virtual knots, the rest of this chapter will be focussed on constructing a generalisation of the alternating knot invariant examined in the first chapter. We will do this from the perspective of the lattices of integer flows of the Tait graphs of the virtual knot rather than equivalent $d$-invariant formulation of \cite{lattices-graphs-mutation}. First we must introduce the tools we used in Chapter 1 into this new virtual setting. We focus on the definition of virtual knots as knots on thickened surfaces under stable equivalence.

We define connected sums for knots in thickened surfaces. Since the definition we give plays well with stable equivalence (connected sums of stabilised knots on thickened surfaces remain stabilised), this gives a well-defined definition for virtual knots.

First, we must define connected sums for close orientable surfaces. The \textit{connected sum} of $\Sigma_{1}$ and $\Sigma_{2}$ is the surface $\Sigma_{1} \hash \Sigma_{2}$, obtained by removing a disk each from $\Sigma_{1}$ and $\Sigma_{2}$, then gluing together the resulting boundary circles. As this does not introduce or remove handles, $g(\Sigma_{1} \hash \Sigma_{2}) = g(\Sigma_{1}) + g(\Sigma_{2})$.

The \textit{annular connected sum} of knots $K_{1}$ in thickened $\Sigma_{1}$ and $K_{2}$ in thickened $\Sigma_{2}$, is defined as illustrated in Fig.~\ref{fig:annular-connected-sum}. It is a knot in a thickened surface $\Sigma$ of genus $g(\Sigma_{1}) + g(\Sigma_{2})$. To find the $K$ such that $(K_{1}, \Sigma_{1}) \hash (K_{2}, \Sigma_{2}) = (K, \Sigma)$, we take a disk $D_{1}$ in $\Sigma_{1}$ whose boundary transversely intersects $K_{1}$ at exactly two points, and such that the $K_{1} \cap D$ is unknotted, and a similar disk $D_{2}$ in $\Sigma_{2}$. We then produce $\Sigma$ and $K$ by the connect sum of $\Sigma_{1}$ and $\Sigma_{2}$, gluing together $D_{1}$ and $D_{2}$, such that each point in the two element set $\partial D_{1} \cap K_{1}$ is glued to an element of $\partial D_{2} \cap K_{2}$.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.6}
	\input{graphics/annular_connect_sum.pdf_tex}
	
	\caption{An example of an annular connected sum of $(K_{1}, \Sigma_{1})$ and $(K_{2}, \Sigma_{2})$ with respect to the gluing disks shown. The knots in thickened surfaces are representatives of virtual knots $3_{7}$ and $2_{1}$.}
	\label{fig:annular-connected-sum}
\end{figure}

\notered{Check the rest of this section with Hans and Zsuzsi.} 

Unlike in the classical case, this is not in general well-defined \cite{virtual-knots-and-links} as there is no way to move $(K_{2}, \Sigma_{2})$ around $(K_{1}, \Sigma_{1})$. Hence, this definition depends on the choice of gluing disks $D_{1}$ and $D_{2}$. However, if $\Sigma_{1} = \Sigma_{2} = \S^{2}$, then this definition is equivalent to the connected sum of classical knots, and well-defined. In general, we write $(K_{1}, \Sigma_{1}) \hash (K_{2}, \Sigma_{2})$ for any of the annular connected sums of $(K_{1}, \Sigma_{1})$ and $(K_{2}, \Sigma_{2})$.

An annular connected sum $(K_{1}, \Sigma_{1}) \hash (K_{2}, \Sigma_{2})$ where one of the summands is the unknot in $\S^{2} \times I$ the sum is said to be \textit{trivial}. A knot in a thickened surface is \textit{prime} if it is not the non-trivial annular connected sum of any two knots in thickened surfaces.

Using these definitions, we extend the connected sum to virtual knots. The \textit{connected sum} of two virtual knots as the annular connected sum of their thickened surface representatives. This is a multivalued operation, as it depends both on the representatives chosen, as well as disks chosen in the annular connected sum.

A connected sum of virtual knots $K = K_{1} \hash K_{2}$ \notered{[change notation $K$ to $V$?]} is \textit{trivial} if one of the summands is the stable equivalence class of the unknot in $S^{2} \times I$ and the other is $K$. A virtual knot (other than the trivial knot) is \textit{prime} if there is no way to write it as a non-trivial connected sum.

Despite the ill-defined nature of the annular connected sum, the decomposition of knots in thickened surfaces into their constituent primes behaves in a nice way on a certain subset of all knots on thickened surfaces. The theorem analogous to Schubert's theorem in the virtual setting is a result of Matveev \cite[Theorem 13]{roots-and-decompositions}.

\begin{theorem}[Matveev's Theorem]
Any virtual knot can be decomposed into a connected sum of prime and trivial virtual knots. The prime summands in this decomposition are determined uniquely, that is, depend only on the initial virtual knot.
\end{theorem}

There is also a weaker version of primality for knots, given by Howie-Purcell \cite{geometry-of-alternating-links-on-surfaces}. \notered{Give definition.}


\section{Alternating Virtual Knots and Virtual Knot Mutation}
In a similar vein to classical knots, we call a surface knot diagram \textit{alternating} if the crossings alternate over and under as the knot is traversed. A knot in a thickened surface is \textit{alternating} if it has an alternating surface knot diagram. An alternating surface knot diagram implies that the thickened surface knot it represents is alternating, but not every surface knot diagram of a thickened surface knot is alternating, for the same reason as in the classical case.

Alternating virtual knots are also something of significance and there are many results specific to them. \notered{Such as? Perhaps ask Hans? The result about their spanning surfaces being positive-definite and negative-definite should wait till Chapter 3.}

\begin{theorem}[Virtual Flyping Theorem]
Let $(K, \Sigma)$ be a knot in a thickened surface. Let $D$ and $E$ be weakly prime, alternating, cellularly embedded surface knot diagrams of $K$. Then $D$ and $E$ are related by a sequence of flypes on $\Sigma$. \notered{Weakly prime diagrams have not been defined.}
\end{theorem}

There are two types of mutation of virtual knots: disk mutation and surface mutation. \textit{Disk mutation} is directly analogous to mutation of classical knots. We take a disk $D \subseteq \Sigma$ that contains a tangle and flip or rotate it, and the resulting knot is a disk mutant of the original. This is in contrast to \textit{surface mutation}, in which the chosen subset need only have circular boundary, but could contain handles. Surface mutation is a more invasive operation and we do not consider it in the present text. However, future work may lie in investigating the equivalence classes generated by surface mutation. For the rest of this text, mutation, in the virtual context, refers to disk mutation.

\section{Checkerboard Colourings and Tait Graphs of Virtual Knots}

In the classical case, all knots were checkerboard colourable, so the Tait graph could always be produced. Furthermore, only one Tait graph was necessary to encode an alternating knot, as the two Tait graphs were always planar duals to each other. We will see that there are some subtleties in the virtual case.

Not all surface knot diagrams are checkerboard colourable: if we take a knot in a thickened surface $\Sigma$ that is checkerboard colourable, such as that in Fig.~\ref{fig:4-105-vknot}, it is always possible to put it on a new surface $\Sigma'$ on which it will not be checkerboard colourable. We do this in Fig.~\ref{fig:4-105-vknot-with-handle} by adding a handle between a black region and a white one, unifying them. The resulting region now needs to be both black and white, so the knot on $\Sigma'$ is not checkerboard colourable. Hence when trying to checkerboard colour virtual knots, the surface needs to be taken into account.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/4-105_vknot_checker.pdf_tex}
		\caption{Virtual knot $4_{105}$}
		\label{fig:4-105-vknot}
	\end{subfigure}
	\hspace*{\fill}	\hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/4-105_vknot_handle.pdf_tex}
		\caption{A handle is added}
		\label{fig:4-105-vknot-with-handle}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{Adding a handle can disrupt checkerboard colourability. \notered{Swap crossings!}}
	\label{fig:adding-handle-to-4-105}
\end{figure}

We say a knot in a thickened surface is \textit{checkerboard colourable} if there is a checkerboard colourable surface knot diagram that represents it. We have the following classification of checkerboard colourable knots in thickened surfaces \cite{minimal-diagrams-surface-links}.

\begin{theorem}
Given a knot in a thickened surface, $K \subset \Sigma \times I$, the following are equivalent:
	\begin{enumerate}[(i)]
	\item $K$ is checkerboard colourable,
	\item $K$ is the boundary of an unoriented spanning surface $F \subset \Sigma \times I$,
	\item $[K] = 0$ in the homology group $H_{1}(\Sigma \times I; \Z_{2})$.
	\end{enumerate} 
\end{theorem}

Likewise, we say a virtual knot is \textit{checkerboard colourable} if there is a representative that is checkerboard colourable (as a knot in a thickened surface). Note that while the knot in a Fig.~\ref{fig:4-105-vknot-with-handle} isn't checkerboard colourable as a knot in a thickened $2\T^{2}$, it is indeed checkerboard colourable as a virtual knot, as after destabilisation we have the knot in Fig.~\ref{fig:4-105-vknot}. Not every virtual knot is checkerboard colourable, even on its surface of minimal genus, for example 

\begin{figure}[hbt!]
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/2-1_vknot.pdf_tex}
		\caption{Virtual knot $2_{1}$.}
		\label{fig:non-cc-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/3-7_vknot.pdf_tex}
		\caption{Virtual knot $3_{7}$.}
		\label{fig:cc-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\caption{Two virtual knots on their surfaces of minimal genus. The left is not checkerboard colourable in the given diagram, as $[K] \neq 0$ in $H_{1}(\Sigma \times I; \Z_{2})$, but the right is. Note the difference between (a) and the knot in Fig.~\ref{fig:cellular-embedding-tricky}.}
	\label{fig:cc-of-vknots}
\end{figure}

For the purposes of generalising the lattice of integer flows of the Tait graph, we need only concern ourselves with alternating virtual knots -- those virtual knots that can be represented by alternating virtual knot diagrams. Fortunately the following theorem tells us that we will not run into any trouble \cite{jones-polynomial-checkerboard-colourable}.

\begin{theorem}[Kamada's Lemma]
	Every alternating virtual knot is checkerboard colourable.
\end{theorem}

For those surface knot diagrams that are checkerboard colourable, we can define the Tait graphs of the knot. In the classical case, these were planar graphs, or planar embeddings of a graph. In the virtual context, they are surface embeddings.

Let $G$ be a connected graph. A \textit{surface embedding} of $G$ is a map $i: G \inject \Sigma$, considered up to orientation-preserving diffeomorphism. Notationally, we use $G$ and $i(G)$ interchangeably. This extra information is equivalent to a cyclic orientation of the edges incident to each vertex $v \in G$, which we call a \textit{rotation system}. A graph with a rotation system is also called a \textit{ribbon graph} or \textit{fat graph}.

The \textit{surface dual} of the cellularly embedded surface embedding $i: G \inject \Sigma$ is another surface embedding $i^{*}: G^{*} \inject \Sigma$, where $G^{*}$ is the graph that has a vertex for every connected component of  $\Sigma \smallsetminus G$, and for each edge $e$ of $G$, a dual edge $e^{\ast}$ connecting the vertices lying on either side of $e$. The map $J$ then assigns vertices and edges of $G^{*}$ to the correct place in $\Sigma$. The requirement that $G$ be cellularly embedded is necessary for the surface dual to be well-defined. \notered{example}

We have a few elementary results about surface duals.

\begin{lemma}
Let $G$ be cellularly embedded, so that $G^{*}$ is defined. Then $G^{*}$ is cellularly embedded.
\end{lemma}

\begin{proof}
Since $G$ is cellularly embedded in $\Sigma$, the Euler characteristic $\chi(\Sigma) = |V(G)| - |E(G)| + |F(G)|$. From the definition of the surface dual, $|V(G^{*})| = |F(G)|$ and $|E(G^{*})| = |E(G)|$. Now let $v$ denote an arbitrary vertex of $G$. Consider the set of edges dual to the edges incident to $v$. This forms a cycle in $G^{*}$ which separates $v$ from all other vertices. Since there are no other edges inside this cycle, it is a face containing only the vertex $v$. Hence, $|F(G^{*})| \leq |V(G)|$. Conversely each connected component of $\Sigma \smallsetminus G^{*}$ is bounded by a cycle of at least one edge, $e^{*}$. The edge $e$ dual to $e^{*}$ terminated within the connected component $\Sigma \smallsetminus G^{*}$, so this component or `face' must contain a vertex, so $|F(G^{*})| \geq |V(G)|$. Hence, the Euler characteristic $\chi(G^{*}) = \chi(G)$, so $G^{*}$ is also cellularly embedded.
\end{proof}

\begin{corollary}
Let $G$ be cellularly embedded, so that $G^{*}$ is defined. Then $G^{**} = G$.
\end{corollary}

\notered{Show that we can reconstruct the knot from the Tait graphs, like in the classical case.}

\section{The Lattice of Integer Flows for Virtual Knots}

This section will be dedicated to asking whether the results about the lattice of integer flows in the classical case generalise to the virtual setting. Like the classical case, we will find that the lattice of integer flows of either Tait graph of a virtual knot is an invariant of alternating virtual knots. However, we will not be able to show that this is a \textit{complete} invariant of alternating virtual knots. In fact, in Chapter 5, we will produce a counterexample to this statement.

As the lattice of integer flows is defined graph-theoretically, the same definition applies in the virtual setting. The difference is that the graph embeddings are no longer planar duals, but surface duals. As a result, the lattice of integer flows of the white Tait graph is no longer isomorphic to the lattice of integer cuts of the black Tait graph, so both $\Lambda_{B}(D)$ and $\Lambda_{W}(D)$ are needed not to unnecessarily lose information about the knot. We present the following example to show this.

Let $K = 5_{2429}$, and $D$ the surface knot diagram given in Fig.~\ref{fig:5-2429-vknot}. The Tait graphs are given abstractly in Fig.~\ref{fig:5-2429-taits-abstract}.

\begin{figure}[hbt]
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/5-2429_cc.pdf_tex}
		\caption{Virtual knot $5_{2429}$\ldots}
		\label{fig:5-2429-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/5-2429_taits.pdf_tex}
		\caption{\ldots with Tait graphs.}
		\label{fig:5-2429-taits}
	\end{subfigure}
	\hspace*{\fill}
	\caption{}
	\label{fig:5-2429-example}
\end{figure}

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.4}
	\input{graphics/5-2429_taits_abstract.pdf_tex}
	\caption{The Tait graphs $G_{B}(D)$ and $G_{W}(D)$.}
	\label{fig:5-2429-taits-abstract}
\end{figure}

With respect to the basis $(e_{1} + e_{2} + e_{3}, e_{4} + e_{5})$, the inner product on $\Lambda_{B}(K)$ has Gram matrix
\[\begin{bmatrix}
3 & 0 \\
0 & 3
\end{bmatrix}\,.\]
Likewise with respect to the basis $(f_{1}, f_{2}, f_{3}, f_{4}, f_{5})$, $\Lambda_{W}(K)$ has Gram matrix
\[\begin{bmatrix}
1 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 1\\
\end{bmatrix}\,.\]

Again, these are only determined by the lattices up to unimodular congruence.

In the classical case, we proved that $\Lambda_{B}(D)$ and $\Lambda_{W}(D)$ were invariants of alternating knots as follows. We used the flyping theorem to relate any prime alternating diagrams via a sequence of flypes. Then, by the lemma that flypes correspond to Whitney flips of the Tait graph, any two prime alternating diagrams of the same knot have isomorphic lattices. Finally we use a series of results to extend this from prime alternating knots to arbitrary alternating knots, including Menasco's theorem and the unique decomposition theorem (Schubert's theorem) for knots.

The virtual case is more complicated. Kindred's virtual flyping theorem applies only to weakly prime alternating knots, and the annular connected sum of virtual knots is a multivalued operation. However there are virtual analogues of each of the results used in the classical proof \notered{[check with Hans]}. An analogous, diagrammatic proof of this statement is the work of the author along with collaborators Hans Boden, Zsuzsanna Dancso and Tilda Wilkinson-Finch will appear in a paper which is currently in draft form.

However in the current text, we give a topological proof by showing that the lattice of integer flows of the Tait graph is equivalent to the topologically defined Gordon-Litherland linking form of Chapter 3. We state this now, but delay the proof until then.

\begin{theorem}
Let $V$ be an alternating virtual knot, and let $D$, $E$ be alternating surface knot diagrams for $V$. Then $\Lambda_{B}(D) \cong \Lambda_{B}(E)$ and $\Lambda_{B}(D) \cong \Lambda_{W}(E)$.
\end{theorem}

Unlike the classical case, $\Lambda_{B}(K)$ and $\Lambda_{W}(K)$ are not equivalent, as this came from the fact that in the plane, the lattice of integer flows of a graph $G$ was isomorphic to the lattice of integer cuts of $G$. This is only true on the plane.

Two statements from the classical case remain to be examined: that $\Lambda_{B}(K)$ (resp. $\Lambda_{W}(K)$) is a mutation invariant, and that $\Lambda_{B}(K)$ (resp. $\Lambda_{W}(K)$) is complete up to mutation.

The first statement holds in the general setting.
\begin{theorem}
Let $V_{1}$ and $V_{2}$ be alternating knots that are mutants. Then $\Lambda_{B}(V_{1}) \cong \Lambda_{B}(V_{2})$ and $\Lambda_{W}(V_{1}) \cong \Lambda_{W}(V_{2})$.
\end{theorem}
\begin{proof}
The proof follows the proof in the classical case exactly. Let $V_{1}$ and $V_{2}$ be mutants. There is a sequence of mutations from $V_{1}$ to $V_{2}$. The lemma from Chapter 1 that a flype move induces a Whitney flip of the Tait graph \notered{[to be made into a lemma]} generalises directly to disk mutation. Thus, their Tait graphs are related by Whitney flips. By Whitney's theorem, the graphs are $2$-isomorphic, and since $\Lambda_{B}(K)$ (resp. $\Lambda_{W}(K)$) is a $2$-isomorphism invariant, we have $\Lambda_{B}(V_{1}) \cong \Lambda_{B}(V_{2})$ (resp. $\Lambda_{W}(V_{1}) \cong \Lambda_{W}(V_{2})$).
\end{proof}

Unlike in the the above proof, the proof that $\Lambda_{B}(K)$ and $\Lambda_{W}(K)$ are complete up to mutation does not generalise. \notered{Is this because one of the results does not generalise, or because the graphs are no longer surface dual, so there is two sequences of Whitney flips, one for $G_{B}(D)$ and one for $G_{W}(D)$, but in general these two sequences do not correspond to the same mutations (or something like that)?} In fact, on the class of virtual knots, even the pair or $\Lambda_{B}(K)$ and $\Lambda_{W}(K)$ is incomplete.

\begin{theorem}
The pair of lattices of integer flows of the Tait graphs of virtual knots, $(\Lambda_{B}(V), \Lambda_{W}(V))$ is not a complete invariant of alternating virtual knots.
\end{theorem}
\begin{proof}
In Chapter $3$, we examine another mutation invariant of virtual knots known as the Gordon-Litherland linking form. In Chapters $4$ and $5$, we present algorithms to compute the Gordon-Litherland linking form and lattice of integer flows of the Tait graphs. Finally, we present two alternating virtual knots, $6_{90101}$ and $6_{90124}$, with different Gordon-Litherland linking forms, but the same lattice of integer flows. Hence $6_{90101}$ and $6_{90124}$ are not mutants, but have the same lattices of integer flows of their Tait graphs, completing the proof.
\end{proof}

\chapter{Gordon-Litherland Linking Form}

\epigraph{\itshape God created the knots. All else in topology is the work of man.}{--- Leopold Kronecker, modified by Dror Bar-Natan}

In particular, we turn our attention to the work of two men: Cameron McA. Gordon and Richard A. Litherland who did \notered{something} \cite{signature-of-a-link}.

Then Hans et. al. made it virtual. It has this interpretation something something double branched covers \cite{gordon-litherland-pairing-thickened-surfaces}.


\notegreen{
Scaffold:
\begin{itemize}
\item Defined for classical knots by Gordon and Litherland.
\item Defined for virtual knots by Hans, Chrisman, Karimi.
\item Also a lattice structure on the Tait graph homology.
\item It's symmetrisation is (equivalent to) the lattice of integer flows.
\item Spanning surfaces. Positive definite and negative definite spanning surfaces characterise alternating links.
\item Unimodular congruence is hard - how can we put it in a nice basis?
\end{itemize}
}


\chapter{Gauss Codes and Knot Algorithms}
\notered{Work in pages already written about the algorithm to find the Tait graph.}


\chapter{Computing Mock Seifert Matrices}

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/6-90101_vknot.pdf_tex}
		\caption{Virtual knot $6_{90101}$}
		\label{fig:6-90101_vknot}
	\end{subfigure}
	\hspace*{\fill}	\hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/6-90124_vknot.pdf_tex}
		\caption{Virtual knot $6_{90124}$}
		\label{fig:6-90124_vknot}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{write}
	\label{fig:counterexamples}
\end{figure}

From the tables produced, it was noticed that the Kobayashi invariant \cite{new-invariant-under-congruence}, defined as
\[\kob A = \operatorname{tr}(A^{\top}A^{-1})\]
always satisfied a relation involving the coefficients of the Alexander polynomial
\[\Delta_{A}(t) \coloneq \det(tA - A^{\top})\] \cite{mock-seifert-matrices}.

\begin{proposition}
The Kobayashi invariant satisfies
\[\kob A = -\dfrac{a_{1}}{a_{0}}\]
where $a_{i}$ is the $i$th coefficient of the Alexander polynomial $\Delta_{A}(t)$.
\end{proposition}
\begin{proof}
The matrix $A$, being a mock Seifert matrix, has odd determinant \cite{mock-seifert-matrices} and is therefore invertible. Hence by the multiplicity of determinants,
\[\det(tA - A^{\top}) = \det(A)\det(tI - A^{\top}A^{-1})\,.\]
The last factor here is the characteristic polynomial of $A^{\top}A^{-1}$. It is a well known fact that the zeroth and first coefficients of the characteristic polynomial of $M$, are $\det(M)$ and $-\operatorname{tr}(M)$ respectively. Hence,
\begin{align*}
-\dfrac{a_{1}}{a_{0}}	& = \dfrac{\operatorname{tr}(A^{\top}A^{-1})}{\det(A^{\top}A^{-1})}\,,
\end{align*}
but as $\det(A^{\top}A^{-1}) = \det(A^{\top})\det(A^{-1}) = \det(A)\det(A^{-1}) = 1$, we have
\[-\dfrac{a_{1}}{a_{0}} = \operatorname{tr}(A^{\top}A^{-1})\]
as required.
\end{proof}

This means that the Kobayashi invariant is weaker than the Alexander polynomial.


\newpage
\printbibliography[title=References]


\appendix
\titleformat{\chapter}[block]
  {\normalfont\Large\bfseries}{Appendix \thechapter}{1em}{\Large}
\titlespacing*{\chapter}{0pt}{40pt}{30pt}

\chapter{Algorithm}


\end{document}