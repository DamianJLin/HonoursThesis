\documentclass[12pt]{report}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Colour Pallete Notes



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% General Packages
\usepackage{amsmath, amssymb, amsthm}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{geometry}
\usepackage{enumerate}

\usepackage[hidelinks]{hyperref}



%%% Font and Text Packages
\usepackage{newpxtext}
\usepackage{newpxmath}

\usepackage[dvipsnames]{xcolor}


%%% Graphics, Figure and Listing Packages
\usepackage{graphicx}
\usepackage{float}
\usepackage{calc}
\usepackage{caption}
\usepackage{subcaption}


%%% Epigraph
\usepackage{epigraph}


%%% Listings
\usepackage{listings}
\usepackage{lstfiracode}


%%% Bibliography Packages
\usepackage[style=alphabetic]{biblatex}
\bibliography{references}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Page Formatting Options
\geometry{left = 2.5cm}
\geometry{right = 2.5cm}
\geometry{top = 2.5cm}
\geometry{bottom = 2.5cm}

%%% Section and Chapter Titling Options

\titleformat{\chapter}[display]
	{\normalfont\bfseries\LARGE}
	{\chaptertitlename~\thechapter}
	{0pc}
	{{\color{black!30!white}\titlerule[2pt]}\vspace{0.8pc}\normalfont\Large}
  
\titleformat{name=\chapter, numberless}[display]
	{\normalfont\bfseries\LARGE}{}{1pc}
	{\normalfont\Large}
  
\titlespacing*{\chapter}{0pt}{30pt}{40pt}

\titleformat{\section}
	{\normalfont\bfseries\large}
	{\normalfont\bfseries\large{\thesection}}
	{1em}
	{}

%%% Hyperlink Formatting Options
\hypersetup{
    colorlinks,
    linkcolor={black},
    citecolor={blue!60!black},
    urlcolor={blue!80!black}
}

%%% Epigraph Options and Setup
\setlength\epigraphwidth{0.6\textwidth}
\setlength{\epigraphrule}{0pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Graphics and Figure Options
% Graphics path (necessary for .svg images).
\graphicspath{{graphics/}}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}

% Caption setup
\captionsetup{margin=1.5cm}


%%% Listings Options
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{codeback}{rgb}{0.95,0.95,0.92}
\lstset{
	language=Python,
	backgroundcolor=\color{codeback},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	style=FiraCodeStyle,   % Use predefined FiraCodeStyle
	basicstyle=\ttfamily,   % Use \ttfamily for source code listings
	numbers=left
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Personal Macros
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\T}{\mathbb{T}}
\renewcommand{\S}{\mathbb{S}}
\newcommand{\ip}[2]{\langle #1, #2 \rangle}
\newcommand{\inject}{\lhook\joinrel\longrightarrow}

\newcommand{\kob}{\operatorname{kob}}
\newcommand{\lk}{\operatorname{\ell\textit{k}}}

\newcommand{\hash}{\ensuremath{\mathbin{\#}}}

%%% Drafting Macros
\newcommand{\notered}[1]{{\color{Red} \textbf{#1}}}
\newcommand{\notegreen}[1]{{\color{Green} \textbf{#1}}}
\newcommand{\noteblue}[1]{{\color{Blue} \textbf{#1}}}

%%% amsthm Options
\newtheorem*{theorem}{Theorem}
\newtheorem*{proposition}{Proposition}
\newtheorem*{conjecture}{Conjecture}
\newtheorem*{lemma}{Lemma}
\newtheorem*{corollary}{Corollary}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
	
%%% Make titlepage.

% Titlepage Options
\author{Damian Lin}
\title{Mutation Invariants of Alternating Virtual Knots}

\cleardoublepage \thispagestyle{empty}
\null \vfil
\begingroup
\LARGE \bfseries \centering
\openup \medskipamount
\thetitle \par \vspace{30pt}
\centering \mdseries \theauthor \par \bigskip
\endgroup
\vfil \vfil \vfil
\begin{center}
	An essay submitted in partial fulfilment of\\
	the requirements for the degree of\\
	Bachelor of Science/Bachelor of Advanced Studies (Honours)
	\vfil\vfil
	{\large Pure Mathematics\\[5pt]
		University of Sydney}\\
	\vskip6mm
	\includegraphics[width=25mm]{graphics/USY_MB1_CMYK_Stacked_Logo}
	\vfil
	\normalsize\today
\end{center}
\vfil
\cleardoublepage

\tableofcontents

\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}

\notered{Write the introduction.}

\chapter*{Acknowledgements}
\addcontentsline{toc}{chapter}{Acknowledgements}

\notered{Acknowledge everyone!}

We would like to thank Hans Boden for an insight into the proof of the proposition in Chapter 5.


\chapter{Knots and the Lattice of Integer Flows}
\epigraph{\itshape ``A knot!'' said Alice, ``oh, do let me help to undo it!''\\``I shall do nothing of the sort!'' said the mouse.}{--- Lewis Carroll, \textit{Alice's Adventures in Wonderland}}

\section{Knots and Knot Invariants}

We begin with a swift introduction to the rich and marvellous study of tangled-up pieces of string: the theory of knots. Despite being a complex and intricate field, any child can intuitively grasp the concept of a knot as a closed loop of string in space. To formalise this and remove any pathological examples that are inconsistent with this intuition, we define a \textit{knot} to be an injective embedding of the circle into $3$-space, $K: \S^{1} \inject \R^{3}$. The requirement that the embedding be injective ensures that the string does not intersect itself. Fig.~\ref{fig:knot-examples} gives a few example knots.

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/unknot.pdf_tex}
		\caption{Unknot or Trivial Knot, $0_{1}$}
		\label{fig:unknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil.pdf_tex}
		\caption{Trefoil Knot, $3_{1}$}
		\label{fig:trefoil}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/6-3_knot.pdf_tex}
		\caption{The knot $6_{3}$}
		\label{fig:6-3-knot}
	\end{subfigure}
	\caption{Some examples of knots, presented through knot diagrams. Their names in the Rolfsen knot table are also given.}
	\label{fig:knot-examples}
	\hspace*{\fill} 
\end{figure}

The example in Fig.~\ref{fig:unknot-twisted} shows a knot that can be `untwisted' to look like the example in Fig.~\ref{fig:unknot}. In general, we do not distinguish between knots if there is some way to deform one, without breaking the circle or passing it through itself, into the other. We say two knots $K_{1}$ and $K_{2}$ are \textit{equivalent} or equal if there is an \textit{ambient isotopy} from $K_{1}$ to $K_{2}$; that is, a continuous map
\[F: \R^{3} \times I \longrightarrow \R^{3}\]
such that at each $t \in I$, the corresponding $f_{t}: \R^{3} \longrightarrow \R^{3}$ is a homeomorphism of $\R^{3}$, and $f_{0}$ is the identity map on $\R^{3}$, while $f_{1} \circ K_{1} = K_{2}$.

Though a central objective of knot theory it to classify knots up to ambient isotopy, it can be hard to write down explicit ambient isotopies directly. Rather, we use other means to classify knots which will be the subject of the remainder of this section.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/unknot_twisted.pdf_tex}
		\caption{A less complicated diagram for the unknot.}
		\label{fig:unknot-twisted}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/unknot_goeritz.pdf_tex}
		\caption{A more complicated diagram for the unknot.}
		\label{fig:unknot-goertiz}
	\end{subfigure}
	\hspace*{\fill}
	\caption{It can be difficult to tell whether two diagrams represent the same knot. The diagram in (b) is from \cite{notes-on-knot-theory}.}
	\label{fig:more-unknots}
\end{figure}

Though we claimed that the objects in Fig.~\ref{fig:knot-examples} were knots, they are really projections of knots onto the plane with markings we call \textit{crossings} to make clear that some \textit{strand} of the knot passes over another strand. We refer to these objects as \textit{knot diagrams}. We consider diagrams equivalent up to planar isotopy as $4$-valent graphs. In other words, diagrams can just as well be thought of as combinatorial objects consisting of a list of crossings with labelled ends, and a a description of how these ends connect. So long as the ends are connected in a planar way, the exact path that connects them is unimportant.

Different diagrams can represent the same knot: for example, the diagrams in Fig.~\ref{fig:unknot} and Fig.~\ref{fig:unknot-twisted}, as the latter could be `untwisted' into the former. It is not always obvious when two diagrams represent the same knot. An example is Fig.~\ref{fig:unknot-goertiz}, yet another diagram for the unknot, but it may not be immediately obvious how this knot can be untangled. The unknot is not special here -- every knot has many diagrams, and there is no upper bound on the number of crossings, as we could continually add twists to an arc to create diagrams with arbitrarily many crossings for any knot. However, each knot does have a lower bound on the number of crossings any diagram representing it can have, which we call its \textit{crossing number}. For example, the crossing number of the unknot is $0$, and the crossing number of the Trefoil knot is $3$, and this lower bound is realised in the diagram in Fig.~\ref{fig:trefoil}.

Diagrams are easier to work with than embeddings, thanks to the following foundational theorem due to Alexander-Briggs  \cite{types-of-knotted-curves} and independently Kurt Reidemeister \cite{elementary-justification-knot-theory}.
\begin{theorem}(The Reidemeister Theorem)
Two knot diagrams $D_{1}$ and $D_{2}$ represent equivalent knots if and only if there is some sequence of finitely many moves of the types given in Fig.~\ref{fig:reidemeister_moves} that transform $D_{1}$ into $D_{2}$.
\end{theorem}

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/reidemeister_1.pdf_tex}
		\caption{\textit{R}I}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/reidemeister_2.pdf_tex}
		\caption{\textit{R}II}
	\end{subfigure}
	\hspace*{\fill}
	\\
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/reidemeister_3.pdf_tex}
		\caption{\textit{R}III}
	\end{subfigure}
	\hspace*{\fill}
	\caption{The Reidemeister moves.}
	\label{fig:reidemeister_moves}
\end{figure}


The early study of knot theory by pioneers such as P.G. Tait, C.N. Little and T. Kirkman involved trying to find, by hand, sequences of moves to show two knots were equivalent. And in hindsight they did remarkably well with so few tools. But Tait himself noted that it was impossible by these means alone to ever prove that two knots were distinct. The modern way we do this is by using knot invariants. If we define some map from knot diagrams to some other class of objects, perhaps a truth value, a polynomial, or a group, and show that none of the Reidemeister moves changes the value of this map, then we have a well-defined function on knots: a \textit{knot invariant}. This allows us to prove that two knots are different, for if they take on different values under some invariant, they must be distinct.

However, invariants are one-sided in nature. Taking different values can tell us that two knots are different, but two knots taking on the same value of some invariant doesn't necessitate that they be equivalent knots. Such an invariant -- one that is an injective function from the class of knots -- is called a \textit{complete} invariant, and while we now know of a zoo of different invariants, we have yet to find what is perhaps the Holy Grail of knot theory: a complete invariant that is also easy to compute.


\section{Connected Sums and Prime Knots}
In order to classify knots, it is helpful to be able to build large knot out of smaller ones, and vice-versa, decompose complicated knots into their simpler ``atomic'' pieces.

Given knots $K_{1}$ and $K_{2}$, we define the connected sum, $K_{1} \hash K_{2}$ as illustrated in Fig.~\ref{fig:connected-sum}. Take $K_{1}$ and $K_{2}$ and remove a small arc from each knot, then reconnect the two cut knots to form $K_{1} \hash K_{2}$.

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.5}
	\input{graphics/connected_sum.pdf_tex}
	\caption{Example of a connected sum with $K_{1} = 3_{1}$ and $K_{2} = 6_{3}$.}
	\label{fig:connected-sum}
\end{figure}


If $K_{1}$ and $K_{2}$ are oriented (equipped with a direction) then there is only one way to connect the cut ends in an orientation-preserving way. Otherwise there are two choices. This choice aside, $K_{1} \hash K_{2}$ is well-defined, as regardless which arc of $K_{1}$ we attached $K_{2}$ to, we could shrink $K_{2}$ to an arbitrarily small size, then pull it around $K_{1}$ to any desired spot, then re-enlarge it. Likewise, the arc chosen on $K_{2}$ does not matter, so the connect sum is independent of choice of arc. In fact, this operation is also associative and commutative \cite[Corollary 7.13]{knots}.

There is a corresponding definition of connected sum for knot diagrams, where the arcs to cut are chosen on the periphery of each diagram and connected in a planar way (without introducing additional crossings).

With this, we have a way of expressing more complicated knots in terms of less complicated knots. We call a knot \textit{prime} if there is no way to write it as the connected sum of non-trivial knots. The only exception is the unknot, which we define not to be prime.  Similarly, we call a knot \textit{composite} if there is a way to write it as the connected sum of at least two knots, none of which is the trivial knot. In this way, the prime knots and the connected sum are in analogy with the prime numbers and multiplication. There is even a unique decomposition theorem for knots, just as for prime numbers \cite[Thoerem 7.12]{knots}:

\begin{theorem}[Schubert's Theorem]
	Each non-trivial knot $K$ is a finite connected sum of prime knots and these factors are uniquely determined, up to permutation of the order of the connected sum. 
\end{theorem}

\section{Alternating Knots, Knot Mutation and the Tait Graph}
We call a knot diagram \textit{alternating} if, traversing the diagram, the crossings alternate under and over. For every diagram that is alternating, it is possible to construct a non-alternating diagram of an equivalent knot: one simply needs to apply a type \textit{R}I Reidemeister move appropriately to any strand of the knot: for example the alternating diagram of the Trefoil knot in Fig.~\ref{fig:trefoil} transforms into the non-alternating diagram in Fig.~\ref{fig:trefoil-nonalternating}. Hence we define an \textit{alternating knot} as a knot which can be represented by an alternating diagram. For low crossing-number, that is for knots that can be represented by diagrams with few crossings, many of the knots are alternating, but this trend quickly reverses as crossing number is increased.

An alternating knot diagram is \textit{reduced} if there are no nugatory crossings. A \textit{nugatory crossing} is a crossing for which there is a circle in the projection plane of the knot diagram which intersects the diagram transversely at that crossing, but nowhere else. Nugatory crossings are those which could be immediately undone to simplify the knot diagram. The diagram in Fig.~\ref{fig:trefoil} is a reduced alternating diagram, while the diagram in Fig.~\ref{fig:trefoil-nugatory} is alternating but not reduced.


\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.23}
		\input{graphics/trefoil_nonalternating.pdf_tex}
		\caption{A non-alternating diagram of the Trefoil knot.}
		\label{fig:trefoil-nonalternating}
	\end{subfigure}
	\hspace*{\fill} \hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.23}
		\input{graphics/trefoil_nugatory.pdf_tex}
		\caption{An alternating but not-reduced diagram of the Trefoil knot.}
		\label{fig:trefoil-nugatory}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{Diagrams of the Trefoil knot.}
	\label{fig:trefoil-diagrams}
\end{figure}

Alternating knots are of particular interest in knot theory, and they possess a number of interesting properties. Tait made a series of conjectures about alternating knots in his early attempts to tabulate knots. The first conjecture is about the crossing number of alternating knots and was proven in 1987 by Kaufmann, Murasugi and Thistlethwaite, all independently \cite{state-models-jones-polynomial, jones-polynomials-classical-conjectures, spanning-tree-expansion-jones-polynomial}. Nonetheless it remains known as the first Tait conjecture.

\begin{theorem}[First Tait Conjecture]
Let $D$ be a reduced alternating knot diagram for a virtual knot $V$. Then $D$ has minimal crossing number.
\end{theorem}

The third of these conjectures is known as the flyping conjecture, and it relates reduced alternating diagrams of the same alternating knot by moves known as flype moves.

A \textit{tangle} in a knot diagram is a region of the plane that is homeomorphic to a disc, such that the knot crosses the boundary of the disc exactly four times, as in Fig.~\ref{fig:kinoshita-terasaka-knot} and Fig.~\ref{fig:conway-knot}. A \textit{flype} move is a diagrammatic move that flips a tangle but does not alter the knot type, as in Fig.~\ref{fig:flype}. \notered{True by case analysis - add as proposition.} Tait's Flyping conjecture was proven by Menasco and Thistlethwaite in \cite[p. 166]{classification-alternating-links}:

\begin{theorem}[Flyping Theorem]
Any two reduced alternating diagrams, $D$ and $E$ of the same prime knot, are related by a sequence of flypes.
\end{theorem}

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.5}
	\input{graphics/flype.pdf_tex}
	\caption{A general flype move.}
	\label{fig:flype}
\end{figure}

This is a Reidemeister-like theorem for alternating knots in that is relates equivalence of diagrams to the existence of a sequence of moves between them.

Knot mutation is another way of constructing new knots from existing ones, preserving the alternating property. If we take a diagram, choose a tangle, and then perform a reflection (up to planar isotopy) of that tangle, either reflecting it left-right or up-down, or across one of the diagonals, the corresponding operation on the knot is known as \textit{mutation}, and the two knots are called \textit{mutants}. Mutants are some of the hardest knots to distinguish, as many of their invariants are the same. An example of this is the Conway the Kinoshita-Terasaka knots, given in Fig.~\ref{fig:kinoshita-terasaka-mutants}.

\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.25}
		\input{graphics/kinoshita-terasaka.pdf_tex}
		\caption{The Kinoshita-Terasaka Knot}
		\label{fig:kinoshita-terasaka-knot}
	\end{subfigure}
	\hspace*{\fill} \hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.25}
		\input{graphics/conway.pdf_tex}
		\caption{The Conway Knot}
		\label{fig:conway-knot}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{The Kinoshita-Terasaka mutants. These are the two non-trivial knots of lowest crossing number that have trivial Alexander polynomial. The disk of mutation is marked. The projections used for these diagrams were taken from \cite[Fig.~2.32]{the-knot-book}.}
	\label{fig:kinoshita-terasaka-mutants}
\end{figure}

To a knot diagram, we associate two graphs known as the \textit{Tait graphs}, shown in Fig.~\ref{fig:tait-example} and explained as follows. We interpret the knot diagram as a tetravalent planar graph that divides the plane into regions. By an application of the Jordan curve theorem, it is possible to colour these regions two colours, black and white, such that adjacent regions are never the same colour. Such a colouring is called a \textit{checkerboard colouring}. Note that in a checkerboard colouring, regions that are diagonal to each other at crossings are necessarily the same colour.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil.pdf_tex}
		\caption{Trefoil Knot\dots}
		\label{fig:trefoil-blank}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil_checker.pdf_tex}
		\caption{\dots with a checkerboard colouring \dots}
		\label{fig:trefoil-checker}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil_checker_tait.pdf_tex}
		\caption{\dots and its Tait graph}
		\label{fig:trefoil-checker-tait}
	\end{subfigure}
	\hspace*{\fill}
	\caption{Producing the Tait graph(s) of the trefoil knot.}
	\label{fig:tait-example}
\end{figure}


In the checkerboard colouring of a diagram, the colouring around each crossing can look one of two ways. According to this, we call the crossings either Type $A$ or Type $B$. In an alternating diagram, all crossings will have the same type \cite[300]{spanning-tree-expansion-jones-polynomial}. The convention for alternating knots is to choose the checkerboard colouring such that all crossings are type $A$.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.28}
		\input{graphics/checkerboard_type_a.pdf_tex}
		\caption{Type $A$.}
		\label{fig:type-a}
	\end{subfigure}
	\hspace*{\fill} \hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.28}
		\input{graphics/checkerboard_type_b.pdf_tex}
		\caption{Type $B$.}
		\label{fig:type-b}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{Crossing Type}
	\label{fig:crossing-type}
\end{figure}


A checkerboard colouring, of a knot diagram specifies two not-necessarily orientable spanning surfaces for the knot: a spanning surface is a surface embedded in $\R^{3}$ whose boundary is the knot. These spanning surfaces are obtained by attaching disks for each coloured region by twisted bands for each crossing, where the twisting direction is specified by the type of the crossing. The convention that all crossings be of type $A$ corresponds with the convention that the black surface be positive definite with respect to the linking form on its first homology. This will be explained further in Chapter 3.

To construct the black Tait graph $G_{B}(D)$, we place a vertex in every black region of the plane. For each crossing we draw an edge between the vertices corresponding to the black region on either side of the crossing, obtaining a planar graph, potentially with multiple edges. The white Tait graph $G_{W}(D)$ is constructed similarly from the vertices corresponding to white regions.

Either of these graphs, along with their plane embeddings retain enough information to construct the other. The \textit{planar dual} of $G$, $G^{*}$, is the graph obtained by replacing every face in the plane embedding of $G$ with a vertex, and every edge in $G$ that separates two faces becoming and edge between the corresponding vertices in $G^{*}$. It can be easily seen from the way Tait graphs are constructed in Fig.~\ref{fig:tait-example} that the two Tait graphs are planar duals: $G_{B}(D)^{*} = G_{W}(D)$ and $G_{W}(D)^{*} = G_{B}(D)$. Because both planar graphs can be constructed from a each other, we sometimes refer to either one as \textit{the} Tait graph of a knot. Later we will examine the more general class of knots in thickened surfaces, for which this duality breaks down, and we will need both Tait graphs.

If we have the Tait graph of an alternating diagram of a knot, we can reconstruct the knot diagram by placing a crossing on every edge of the Tait graph, as seen in Fig.~\ref{fig:trefoil-tait-with-crossings}. Connecting up the crossings by strands along the Tait graph, as in Fig.~\ref{fig:trefoil-resconstructed},	 reconstructs the knot diagram, up to planar isotopy.

\begin{figure}[h]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/trefoil_reconstruct_crossings.pdf_tex}
		\caption{Draw crossings on edges.}
		\label{fig:trefoil-tait-with-crossings}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/trefoil_reconstructed.pdf_tex}
		\caption{Connect the crossings.}
		\label{fig:trefoil-resconstructed}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.2}
		\input{graphics/trefoil.pdf_tex}
		\caption{The reconstructed trefoil.}
		\label{fig:trefoil-resconstructed-isotopy}
	\end{subfigure}
	\hspace*{\fill}
	\caption{Reconstructing a knot diagram from its Tait graph.}
	\label{fig:tait-reconstruction-example}
\end{figure}

\section{The Lattice of Integer Flows}

For the rest of this chapter, we introduce the lattice of integer flows of a graph, then largely following \cite{lattices-graphs-mutation}, we show that the lattice of integer flows of the Tait graph is a complete mutation invariant of alternating knots. This means that it is both an invariant of alternating knots, and takes the same value on alternating knots if and only if they are mutants. We then talk about the equivalent formulation given in \cite{lattices-graphs-mutation} as the $d$-invariant.

A \textit{lattice} is a finitely generated abelian group $L$, equipped with an inner product 
\({\ip{\cdot}{\cdot}: L \times L \longrightarrow \R}\). All lattices in this text will be \textit{integral lattices}, meaning the inner product's image is contained within $\Z$. An \textit{isomorphism of lattices} is a bijection $\psi: L_{1} \longrightarrow L_{2}$ that preserves the inner product, that is, ${\ip{x}{y} = \ip{\psi(x)}{\psi(y)}}$ for all $x, y \in L$.

Let $G = (E, V)$ be a finite, connected graph (in which loops and multiple edges are allowed) with vertex set $V$ and edge set $E$. In particular, $G$ is a 1-dimensional CW-complex with boundary map $\partial: C_{1}(G) \longrightarrow C_{0}(G)$. In the edge basis of $C_{1}(G)$ and vertex basis of $C_{0}(G)$, this is a map $\Z^{E} \longrightarrow \Z^{V}$, and is represented by the $|V|\times|E|$ incidence matrix $D$ with entries given by
\[D_{ij} = \begin{cases}
	+1 & \text{if $e_{i}$ is oriented into $v_{j}$,}   \\
	-1 & \text{if $e_{i}$ is oriented out of $v_{j}$,} \\
	0  & \text{if $e_{i}$ is a loop at $v_{j}$ or is not incident to $v_{j}$.}
\end{cases}\]

The \textit{lattice of integer flows} of $G$ is the free abelian group $\Lambda(G) = \ker \partial$, along with the inner product induced by the Euclidean inner product on $\Z^{E}$. Equivalently, $\Lambda(G)$ is the first homology group of $G$, with inner products taken in $C_{1}(G)$. While the lattice $\Lambda(G)$ may depend on the orientation of the edges in $G$, its isomorphism class does not, as the isomorphism class of the homology group is independent of orientation, and the Euclidean inner product is preserved by sending an edge to its negation: $\ip{e_{i}}{e_{i}} =  \ip{-e_{i}}{-e_{i}} = 1$, and $\ip{e_{i}}{e_{j}} = \ip{-e_{i}}{e_{j}} = 0$ for $i \neq j$.

As an example, let $D$ be the diagram of the Trefoil knot given in Fig.~\ref{fig:tait-example} the Tait graphs of the trefoil knot   are shown in Fig.~\ref{fig:trefoil-abstract-tait}. We compute the lattice of integer flows of each of these graphs, $\Lambda(G_{B}(D))$ and $\Lambda(G_W(D))$. Rather than use this cumbersome notation, we shorten this to $\Lambda_{W}(D)$ or $\Lambda_{B}(D)$ for the lattice of integer flows of the Tait graph corresponding to the white/black regions, respectively. We orient the graphs arbitrarily to compute the lattice of integer flows, but as we will see the invariant produced is independent of this choice. We start with the more typical lattice of integer flows: that of the Tait graph corresponding to the white region (red in Fig.~\ref{fig:trefoil-abstract-tait}). There are two independent cycles, $-f_{1} + f_{2}$ and $-f_{2} + f_{3}$, so $\Lambda_{B}(3_{1})$ is generated as
\[\Lambda_{B}(D) = \langle -f_{1} + f_{2}, -f_{2} + f_{3} \rangle\,.\]
We are taking inner products in $\Z^{E}$ (that is, in the basis {$(f_{1}, f_{2}, f_{3})$}, so if $x$ and $y$ are coordinate vectors for $u$, and $v$, of two elements of $\Lambda_{B}(D)$ expressed in the basis $(-f_{1} + f_{2}, -f_{2} + f_{3})$, then
\[\langle u, v \rangle = x^{\top}\begin{bmatrix}
	2  & -1 \\
	-1 & 2
\end{bmatrix}y\,.\]
We call this matrix the \textit{pairing matrix} of the lattice $\Lambda_{B}(D)$ with respect to the basis ${(-f_{1} + f_{2}, -f_{2} + f_{3})}$.

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.4}
	\input{graphics/trefoil_abstract_tait.pdf_tex}
	\caption{The Tait graphs $G_{B}(D)$ and $G_{W}(D)$.}
	\label{fig:trefoil-abstract-tait}
\end{figure}

The pairing matrix of a lattice completely describes the lattice, however the pairing matrix is not completely determined by the lattice. Instead, the lattice only determines a pairing matrix up to unimodular congruence: two matrices $P$ and $P'$ are \textit{unimodular congruent} if there exists a matrix $A$ with $\det(A) = 1$, such that $P = A^{\top}P'A$. If $P$ is a pairing matrix of a lattice with respect to the basis $\mathcal{B}$ (with basis matrix $B$), and $P'$ is unimodular congruent to $P$ as above, then:
\begin{align*}
	\langle u, v \rangle & = [u]_{\mathcal{B}}^{\top} P [v]_{\mathcal{B}}                    \\
	                     & = B[u]_{\mathcal{E}}^{\top} P B[v]_{\mathcal{E}}                  \\
	                     & = B[u]_{\mathcal{E}}^{\top} A^{\top} P' A B[v]_{\mathcal{E}}      \\
	                     & = \left( AB[u]_{\mathcal{E}} \right)^{\top} P' AB[v]_{\mathcal{E}} \\
	                     & = \left( [u]_{\mathcal{AB}} \right)^{\top} P' [v]_{\mathcal{AB}}\,,
\end{align*}
so $P'$ is also a pairing matrix of the lattice with respect to the basis whose basis matrix is $AB$.


Continuing with our example, there is a single independent cycle in $G_{W}(D)$, it being $e_{1} + e_{2} + e_{3}$. Hence the pairing matrix of $\Lambda_{W}(D)$ with respect to $( e_{1} + e_{2} + e_{3})$ is $P = [3]$.

Since the 1970's, many graph theorists have studied exactly how much information about the graph $G$ is retained by $\Lambda(G)$ \parencite{lattice-of-flows-cuts, torelli-for-graphs-tropical-curves, lattice-of-flows-regular-matroid}. In the next paragraph we see that some information about $G$ is lost.

We call and edge $e$ of a graph $G$ a \textit{bridge} if the removal of $G$ from $e$ disconnects $G$, and we say a graph $G$ is \textit{$2$-edge-connected} if $G$ has no bridges. The lattice of integer flows of $G$ is blind to its bridges. We define $G_{\bullet}$ as $G$ with its bridges contracted: that is, for each bridge $e$, we remove $e$ and identify the adjacent vertices, then $\Lambda(G_{\bullet}) = \Lambda(G)$. This is because the cycles of $G$, and therefore the homology of $G$, do not see bridges.

A \textit{$2$-isomorphism} between two graphs $G = (E, V)$ and $G' = (E', V')$ is a bijection \({\psi: E \longrightarrow E'}\) which preserves cycles, i.e. $\partial(e_{i} + \cdots + e_{j}) = 0$ if and only if $\partial\left(\psi(e_{i}) + \cdots + \psi(e_{j})\right) = 0$. It is well established that $\Lambda(G)$ is a $2$-isomorphism invariant \parencite{lattice-of-flows-cuts}. Recent work by Su-Wagner and Caporaso-Viviani have also shown that for $2$-edge-connected graphs, $\Lambda(G)$ is a complete $2$-isomorphism invariant \cites[Theorem 3.1.1]{torelli-for-graphs-tropical-curves}[Theorem 1]{lattice-of-flows-regular-matroid}. This is stated in the following theorem, which derives its name from a similar result in the context of algebraic geometry.


\begin{theorem}[Torelli Theorem for Graphs]
For two $2$-edge-connected graphs $G$ and $G'$, $\Lambda(G) \cong \Lambda(G')$ if and only if $G$ and $G'$ are $2$-isomorphic.
\end{theorem}

The notion of $2$-isomorphism is completely characterised in the following way. Two graphs $G$ and $G'$ are related by a \textit{Whitney flip} if it is possible to find two disjoint graphs $\Gamma_{1}$, with distinguished vertices $u_{1}$ and $v_{1}$ and $\Gamma_{2}$ with distinguished vertices $u_{2}$ and $v_{2}$, such that the identifications $u_{1} = u_{2} = u$ and $v_{1} = v_{2} = v$ form $G$, and the identifications $u_{1} = v_{2} = u'$ and $v_{1} = u_{2} = v'$ form $G'$. An example of graphs related by a Whitney flip is given in Fig.~\ref{fig:whitney_flip}.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.5}
	\input{graphics/whitney_flip.pdf_tex}
	
	\caption{An example of a Whitney flip.}
	\label{fig:whitney_flip}
\end{figure}

It is clear that sequences of Whitney flips only ever transform graphs within their $2$-isomorphism class, as cycles map to cycles. From \cite{2-isomorphic-graphs}, we have the important converse; a Reidemeister-like theorem for $2$-isomorphic graphs.

\begin{theorem}[Whitney's Theorem]
Two graphs $G$ and $G'$ are $2$-isomorphic if-and-only-if there is a sequence of Whitney flips relating $G$ to $G'$.
\end{theorem}

Our aim now is to show that $\Lambda_{B}(D)$ and $\Lambda_{W}(D)$ are invariants of alternating knots.  In particular, we draw attention to the author's original geometric proof of this fact, in contrast with the topological arguments given in \cite{lattices-graphs-mutation}.

The plan is to use the flyping theorem to relate alternating diagrams of the same knot by sequences of flypes.  We will discover that these translate into sequences of Whitney flips on the Tait graph. Whitney's theorem and the Torelli theorem for graphs will then relate the lattices of integer flows of the Tait graph of each diagram. The main complication will be that the flyping theorem only relates alternating diagrams of prime knots. We begin with some lemmas that help us remedy this situation.

The first lemma, tells us how flypes alter the Tait graph.

\begin{lemma}
	A flype move on a knot diagram $D$ corresponds to a Whitney flip on the Tait graph of $D$.
\end{lemma}

\begin{proof}
	Flipping the tangle upside down corresponds to changing the embedding of the Tait graph, but the graph itself remains unaltered. The remaining graph operation, moving the crossing in Fig.~\ref{fig:flype} to the other side corresponds to a Whitney flip with $u = v'$ and $u' = v$ being the two vertices corresponding to the coloured regions that enter either side of the tangle, and $\Gamma_{1}$ and $\Gamma_{2}$ being the two disjoint graphs formed by removing $u$ and $v$, with $u$ and $v$ replaced.
\end{proof}


The second lemma is a theorem due to Menasco \cite{closed-incompressible-surfaces}, which has also been aptly paraphrased as ``an alternating knot is prime if and only if it looks prime'' \cite{the-first-two-million-knots}:

\begin{lemma}[Menasco]
	Suppose $K$ is a knot that has an alternating diagram $D$. Then $K$ is a prime knot if and only if $D$ is a prime diagram.
\end{lemma}

The third lemma is a textbook fact about alternating knots \cite{introduction-knot-theory}.

\begin{lemma}
	Let $K = K_{1} \hash K_{2} \hash \cdots \hash K_{n}$. Then $K$ is alternating if and only if for all $i \in \{0, \cdots, n\}$, $K_{i}$ is alternating.
\end{lemma}

The fourth lemma is a result of Kauffman, Murasugi and Thistlethwaite, a corollary of their proofs of the first Tait conjecture \cite{state-models-jones-polynomial, jones-polynomials-classical-conjectures, spanning-tree-expansion-jones-polynomial}.

\begin{lemma}[Kauffman, Murasugi, Thistlethwaite]
	A reduced diagram of a prime alternating knot is alternating.
\end{lemma}

We this, we prove that the lattice of integer flows of the Tait graph is an invariant of alternating knots.

\begin{theorem}
	Let $K$ be alternating, and let $D$, $E$ be alternating diagrams for $K$. Then $\Lambda_{B}(D) \cong \Lambda_{B}(E)$.
\end{theorem}

\begin{proof}
All non-reduced alternating diagrams of $K$ reduce to an alternating diagram for $K$ without changing the lattice of integer flows of their Tait graphs, so we may assume that $D$ and $E$ are alternating reduced diagrams for $K$. 

First we consider the case where $K$ is a prime knot. By the flyping theorem, $D$ and $E$ are related by a sequence of flypes. As flypes induce Whitney flips of the Tait graph, and by Whitney's theorem, $G_{B}(D)$ and $G_{B}(E)$ are $2$-isomorphic. As reduced diagrams of alternating knots are $2$-edge-connected, the Torelli Theorem for Graphs applies, and so $\Lambda_{B}(D) \cong \Lambda_{B}(E)$.

We also consider where $K$ is composite. By Schubert's Theorem,
\[K = K_{1}  \hash K_{2}  \hash \cdots  \hash K_{n}\,,\]
with each $K_{i}$ prime for $i \in \{1, \cdots, n\}$, and this decomposition is unique up to permutation. By the first lemma, $K$ is composite, so $D$ is a composite diagram:
\[D = D_{1}  \hash D_{2}  \hash \cdots  \hash D_{m}\,,\]
for some $m > 1$. We may assume that each $D_{i}$ is a prime diagram, otherwise, we could further factor the connected sum. By the second lemma, each $[D_{i}]$ (by this notation we mean the knot corresponding to the diagram $D_{i}$) is an alternating knot. Furthermore, again applying Menasco's theorem, we see that the knot $[D_{i}]$ represented by each $D_{i}$ is prime. We now have two prime decompositions for $K$:
\[K = K_{1}  \hash K_{2}  \hash \cdots  \hash K_{n}\,,\]
and
\[K = [D_{1}]  \hash [D_{2}]  \hash \cdots  \hash [D_{m}]\,.\]
By Schubert's theorem, and by relabelling the $D_{i}$, we have that $m = n$ and $[D_{i}] = K_{i}$
for each $i \in \{0, \cdots, n\}$. Without loss of generality, \[E = E_{1} \hash E_{2} \hash \cdots \hash E_{n}\,,\] and the same is true for the $E_{i}$, hence
$[D_{i}] = [E_{i}]$
for all $i \in \{1, \cdots, n\}$.

We have that each $[D_{i}]$ or $[E_{i}]$ is a prime alternating knot, and each $D_{i}$ or $E_{i}$ is a reduced diagram, as $D$ and $E$ were reduced. So the theorem of Kauffman, Murasugi and Thistlethwaite gives that each $D_{i}$ and $E_{i}$ is an alternating diagram. For each $D_{i}$ and $E_{i}$, we now have the hypothesis of the first case satisfied: we have two alternating, reduced diagrams for the same prime alternating knot, so $\Lambda_{B}(D_{i}) \cong \Lambda_{B}(E_{i})$ for all $i \in \{0, \cdots, n\}$.

Finally, since the Tait graph of a connected sum of knots is graph formed by identifying a vertex of each Tait graphs of the factor knots,
\begin{align*}
	\Lambda_{B}(D) & = \Lambda_{B}(D_{1}) \oplus \Lambda_{B}(D_{2}) \oplus \cdots \oplus \Lambda_{B}(D_{n}) \\
	               & = \Lambda_{B}(E_{1}) \oplus \Lambda_{B}(E_{2}) \oplus \cdots \oplus \Lambda_{B}(E_{n})\\
	               & = \Lambda_{B}(E)\,. \qedhere \\ 
\end{align*}
\end{proof}

This shows that $\Lambda_{B}(D)$ and $\Lambda_{B}(D)$ is a well-defined function on alternating knots, and henceforth we may write $\Lambda_{B}(K)$ so long as $K$ is alternating.

By the same argument $\Lambda_{W}(D)$ is also an invariant of alternating knots. However combining these two invariants retains no information: they are equivalent invariants to each other.

\begin{theorem}
For an alternating knots $K_{1}$ and $K_{2}$, $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$ if and only if $\Lambda_{W}(K_{1}) \cong \Lambda_{W}(K_{2})$.
\end{theorem}

% TODO: Zsuzsi should check this. What are some good references?
\begin{proof}
There is another lattice associated to a graph called the \textit{lattice of integer cuts}. This is defined as $\operatorname{im} \partial^{*}$, where $\partial^{*}: \Z^{V} \longrightarrow \Z^{E}$ is the map adjoint to the boundary map $\partial$, expressible as
\[\partial^{*}(v) = v \longmapsto \sum_{e \in E} \langle \partial(e), v \rangle e\,.\]

The lattice of integer cuts is the lattice dual to the lattice of integer flows hence we denote it $\Lambda^{*}(G)$. We will not go into depth about lattice theory, but it suffices to say that there are purely lattice-theoretic means to construct $\Lambda^{*}(G)$ from $\Lambda(G)$.

We have seen already that $\Lambda(G)$ is a complete $2$-isomorphism invariant, and the same is true for $\Lambda^{*}(G)$. Hence, $\Lambda(G)$ and $\Lambda^{*}(G)$ determine each other up to $2$-isomorphism.

A useful property of planar graphs $G$ is that the lattice of integer flows of $G$ is isomorphic to the lattice of integer cuts of $G^{*}$. In our conveniently chosen notation, $\Lambda(G) \cong \Lambda^{*}(G^{*})$. Taking the dual of both sides we see $\Lambda^{*}(G) \cong \Lambda(G^{*})$.

Applying this to $\Lambda_{B}(K_{1})$ and $\Lambda_{B}(K_{2})$, we get
$\Lambda_{W}^{*}(K_{1}) \cong \Lambda_{W}^{*}(K_{1})$ and so $\Lambda_{W}(K_{1}) \cong \Lambda_{W}(K_{1})$
\end{proof}

The statement that $\Lambda(G) \cong \Lambda^{*}(G^{*})$ is true only for planar graphs, and when we later consider a non-planar version of this theory, we will not find a similar result.

It only remains to show that $\Lambda_{B}(K)$ is a complete invariant up to mutation. The following lemma examines the effect of mutation on the Tait graph \cite[Lemma 4.5]{lattices-graphs-mutation}:

\begin{lemma}[Greene]
Depending on the tangle to be mutated, a mutation of $D$ either:
\begin{itemize}
\item affects only the planar embedding of the Tait graph, leaving its graph structure unchanged, or
\item induces a Whitney flip in the Tait graph.
\end{itemize}
Conversely, a Whitney flip in the Tait graph induces a mutation in $D$.
\end{lemma}

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.65}
	\input{graphics/mutation_whitney_flip.pdf_tex}
	
	\caption{A mutation may induce a Whitney flip. Figure modified from \cite[Fig.~2]{lattices-graphs-mutation}.}
	\label{fig:mutation-whitney-flip}
\end{figure}

A single case in the proof of this lemma can be found in Fig.~\ref{fig:mutation-whitney-flip}. For the full proof including remaining cases consult \cite[Fig. 2-4]{lattices-graphs-mutation}. Greene uses this lemma to prove that the lattice of integer flows of the Tait graph is a complete mutation invariant of alternating knots \cite[Proposition 4.4]{lattices-graphs-mutation}.

\begin{theorem}[Greene]
Let $K_{1}$ and $K_{2}$ be alternating knots. Then $K_{1}$ and $K_{2}$ are mutants if and only if  $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$.
\end{theorem}

\begin{proof}
Let $K_{1}$ and $K_{2}$ be alternating virtual knots. For the forward implication, suppose that $K_{1}$ and $K_{2}$ are mutants, so there is a sequence of mutations from a diagram of $K_{1}$ to a diagram of $K_{2}$. By the lemma above, their Tait graphs $G_{B}(K_{1})$ and $G_{B}(K_{2})$  are related by Whitney flips. By Whitney's theorem, each of these pairs of graphs are $2$-isomorphic. Since $\Lambda_{B}(G)$ is a $2$-isomorphism invariant, $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$.

For the reverse implication, take two alternating knots such that $\Lambda_{B}(K_{1}) \cong \Lambda_{B}(K_{2})$. We may assume them to be reduced, as reduction of a knot does not alter the lattice of integer flows of its Tait graphs. As the knots are reduced, their Tait graphs $2$-edge-connected. So, by the Torelli theorem for graphs, $G_{B}(K_{1})$ and $G_{B}(K_{2})$ are $2$-isomorphic. By Whitney's theorem, there is a sequence of Whitney flips between each of these pairs, which by the lemma above corresponds to a sequence of mutations between $K_{1}$ and $K_{2}$, so they are mutants.
\end{proof}

\section{Heegaard-Floer Homology and the $d$-invariant}

\notered{Alert! I need to edit this section heavily to hide the fact that I don't know the meaning of any of these words!}

Heegaard-Floer homology is a homology theory introduced in a series of papers by Peter Ozsv\'ath and Zoltan Sz\'abo at the turn of the 21st century. The theory consists of a powerful set of topological invariants that fit within a topological quantum field theory. It has proven to be incredibly useful in low-dimensional topology. \notered{Reference original papers and ams thing.}

Greene shows that the lattice of integer flows of a graph can be reduced into an equivalent, more concise invariant called the $d$-invariant. When this is applied to the Tait graph of a knot, we refer to it as the `lattice-theoretic' $d$-invariant. Greene shows that this is  equivalent to a construction from Heegaard-Floer' homology known as the $d$-invariant of the of the double branched-cover of of the knot (which we refer to as the `Heegaard-Floer' $d$-invariant) \cite{lattices-graphs-mutation}.
\noteblue{Below we briefly review the construction of the lattice-theoretic $d$-invariant. Computationally, this is fairly straightforward to implement.} In Chapter $2$, we define the lattice of integer flows and $d$-invariant for virtual knots \notered{make a note in that chapter} and in \notered{appendix A/B we include a table of $d$-invariants for alternating virtual knots up to 6.} 

In particular, Greene shows that instead of considering the whole lattice $\Lambda_{B}(K)$, it suffices to look at a particular coset of the dual lattice called the \textit{characteristic coset}:
\[\operatorname{Char} \Lambda = \left\{ \chi \in \Lambda^{*} \ \Big|\  \langle\chi,\lambda\rangle \equiv \langle\lambda,\lambda\rangle \pmod 2\  \forall \lambda \in \Lambda \right\}\,.\]
The $d$-invariant is a scaled function that takes an element of the quotient $(\operatorname{Char} \Lambda_{B}(K)) / (2 \Lambda_{B}(K))$ to the norm of its minimal-norm representative. Greene shows that this reduction is equivalent to the while lattice of integer flows by lattice-gluing techniques.


\chapter{Virtual Knots}

\epigraph{\itshape I thought this was the end\\But no my friends, this is when\\We get to do it all again...}{--- The Muppets, \textit{We're Doing a Sequel}}
\epigraph{\itshape ...and now it's virtual...}{--- Jamiroquai, \textit{Virtual Insanity}}


We now introduce the exciting and relatively new theory of virtual knots. Virtual knots are a generalisation of knots, and there are many different equivalent formulations of them. We start with the most geometric of the formulations, but we also present a combinatorial definition of computational significance later.


\section{Knots in Thickened Surfaces}

In this section we will largely follow the work of Kuperberg \cite{what-is-a-virtual-link} and Carter-Kamada-Saito \cite{stable-equivalence-virtual-cobordisms} and give the geometric definition of virtual knots as knots in thickened surfaces.

\textit{Classical} knots, a term which refers specifically to the kind of knots we have introduced in Chapter 1, are represented by diagrams in the plane, $\R^{2}$, but really they have an extra dimension of `thickness', encoded in the diagram by the under- and over- crossings. That is, knots are embeddings of a circle in the ``thickened plane'', in other words $\R^{3}$. However, we didn't really need a whole $\R$'s worth of extra space. We could easily think of classical knots as living in a thickened plane, $\R^{2} \times I$ where $I$ is the unit interval $[0, 1]$. Thinking of knots as embeddings in $\R^{2} \times I$, it becomes natural to ask: what if we replace the plane by another surface; can we draw diagrams on other surfaces $\Sigma$ and therefore knots in \textit{thickened surfaces} $\Sigma \times I$? The answer to these questions is yes, and virtual knots are one such generalisation.

In the context of virtual knots, all surfaces of relevance are closed and orientable. Note that classical knots fit into this picture, as knot diagrams on the plane are equivalent to knot diagrams on the sphere. The only extra move allowed by this one-point compactification is that a strand on one side of a knot diagram can be taken over to the other by spherical isotopy of moving it around the back side of the sphere. However this was already allowed on the plane by a sequence of R\textit{III} and R\textit{II} moves.

There is a well-known classification theorem for closed, orientable surfaces as follows.

\begin{theorem}[Classification of compact, orientable surfaces]
Each connected component of a compact, orientable surface is homeomorphic to:
\begin{itemize}
	\item the sphere, $\S^{2}$, or
	\item a connected sum of $g$ tori, $g\T^{2}$, for $g \geq 1$.
\end{itemize}
\end{theorem}
Hence there is a bijection between connected components of compact, orientable surfaces and the natural numbers given by the \textit{genus}, $g$ of the surface: the number of handles.

A \textit{surface knot diagram} on $\Sigma$ is the analogue of a classical knot diagram, but drawn on a closed, oriented, connected surface, $\Sigma$, which is no longer necessarily the plane. The equivalence relation on surface knot diagrams is given by the Reidemeister moves and surface isotopy (the surface-analogue of planar isotopy) on $\Sigma$.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.6}
	\input{graphics/3-7_on_torus.pdf_tex}
	
	\caption{A surface knot diagram on $\Sigma = \T^{2}$.}
	\label{fig:surface-knot-diagram-example}
\end{figure}

Instead of drawing surface knot diagrams directly on compact orientable surfaces, for genus $g \geq 1$, we often draw on the gluing diagrams of those surfaces. From a textbook theorem of algebraic topology \parencite[Chapter 0]{algebraic-topology}, the compact orientable surface of genus $g$ is obtained from the $4g$-gon by gluing around the polygon with the pattern $aba^{-1}b^{-1}$,~$cdc^{-1}d^{-1}$,~$\cdots$ continuing on for $g$ iterations, that is, until all edges have been glued. Fig.~\ref{fig:surface-knot-diagram-examples} shows gluing diagrams for $\T^{2}$ and $2\T^{2}$.
\begin{figure}[hbt!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.26}
		\input{graphics/unknot_on_surface.pdf_tex}
		\caption{A surface knot diagram on $\Sigma = \T^{2}$}
		\label{fig:torus-unknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.26}
		\input{graphics/3-7_vknot.pdf_tex}
		\caption{A more complicated surface knot diagram on $\Sigma = \T^{2}$}
		\label{fig:torus-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.3 \textwidth}
		\centering
		\def\svgscale{0.24}
		\input{graphics/6-90101_vknot_small.pdf_tex}
		\caption{A surface knot diagram on $\Sigma = 2\T^{2}$}
		\label{fig:2torus-vknot}
	\end{subfigure}
	\caption{Some examples of surface knot diagrams. Note that classical knot diagrams would also be examples with $\Sigma = S^{2}$.}
	\label{fig:surface-knot-diagram-examples}
	\hspace*{\fill} 
\end{figure}

Knots in thickened surfaces relate to surface knot diagrams, in the same way knots and knot diagrams are related in the classical context. A \textit{knot in a thickened surface} $\Sigma \times I$ is an embedding $K:S^{1} \inject \Sigma \times I$ up to ambient isotopy in $\Sigma \times I$. We denote a knot $K$ in thickened surface $\Sigma \times I$ as $(K, \Sigma)$. The diagram of $K$ is a projection of $K$ onto $\Sigma$ with under- and over-crossings.

We say a surface knot diagram is \textit{cellularly embedded} if $\Sigma \smallsetminus D$ is a union of disks. Being cellularly embedded is a way to check that a knot `fully utilises' the surface it is drawn on, in the following sense. Observe that the surface knot diagrams in Fig.~\ref{fig:torus-vknot} and Fig.~\ref{fig:2torus-vknot} are cellularly embedded, and in fact. these surface knot diagrams could not be drawn on a surface of lower genus. If, for example, one was to try draw the surface knot diagram in Fig.~\ref{fig:torus-vknot} on the plane, connecting the four pairs of loose ends at the sides would not be possible without introducing additional crossings. In contrast, the surface knot diagram in Fig.\ref{fig:torus-unknot} represents the unknot drawn as a homologically non-trivial curve on the torus. This could be drawn on the plane/sphere, however we don't yet have a notion of equivalence for surface knot diagrams (or knots in thickened surfaces) that live on surfaces of different genus.

Note that while a non-cellularly-embedded diagram could be drawn on a surface of lower genus, the converse does not hold: a knot that is cellularly embedded might still be able to be drawn on a diagram of lower genus, such as in Fig.~\ref{fig:cellular-embedding-tricky}. These examples motivate the definition of stable equivalence in the next section.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.56}
	\input{graphics/torus_unknot_tricky.pdf_tex}
	
	\caption{An example of surface knot diagram which transforms to a not-cellularly-embedded diagram only after some Reidemeister moves. The single face in the final diagram contains a non-homologically-trivial cycle, marked in red, and hence is not contractible (not a disk). \notered{add wiggly arrows}}
	\label{fig:cellular-embedding-tricky}
\end{figure}

\section{Stable Equivalence and Virtual Knots}

Virtual knots are knots in thickened surfaces of any genus modulo the equivalence relation of stable equivalence. We give the definition on the level of surface knot diagrams, but it can be stated equivalently for embeddings $K \inject R \times I$.

The operation of \textit{stabilisation} is defined as follows: find two disks $B_{1}$ and $B_{2}$ in $\Sigma$ that do not intersect $D$, remove $B_{1}$ and $B_{2}$ from $\Sigma$ and then glue a handle whose boundary is $B_{1} \cup B_{2}$. Intuitively, stabilisation is `adding a handle' to $\Sigma$, and any newly added handle does not interact with $P$.

The reverse operation \textit{destabilisation} is defined as follows: Take a cylinder $Y$ that does not intersect $D$, and such $Y$ does not deformation-retract to not a null-homologous circle. Removes the $Y$, and glue a cap to both resulting boundary circles.

The point of stable equivalence is to identify two knot diagrams $D_{1}$ and $D_{2}$ that would otherwise be identical, except for living on surfaces $\Sigma_{1}$ and $\Sigma_{2}$ of different genus as in the example above.

Hence we define a \textit{virtual knot} as an equivalence class of knots in thickened surfaces under stable equivalence. Two surface knot diagrams represent the same virtual knot if there is some sequence of Reidemeister moves and stabilisation/destabilisation moves from one diagram to the other.

For a virtual knot we use the notation $V$, but when referring to knots in thickened surfaces (such as specific representatives of virtual knots), we use $(K, \Sigma)$. That is, we use $V$ when the object is being considered up to stable equivalence and $K$ otherwise.

The \textit{virtual genus} $g_{v}$ of a virtual knot $V$ is defined as the minimum genus of all surface knot diagrams for $V$. The virtual knots with virtual genus $g_{v} = 0$ are classical knots, and the virtual knots with virtual genus $g_{v} > 0$ are \textit{strictly} virtual. The virtual knots in Fig.~\ref{fig:torus-vknot}~and~\ref{fig:2torus-vknot} are examples of strictly virtual knots.

An important question to ask is whether classical knot theory embeds faithfully into virtual knot theory: are there distinct classical knots which, when considered as virtual knots are rendered equivalent by stable equivalence? A uniqueness result of Kuperberg dispels this possibility and in fact gives the even stronger result that we \textit{never} need to go `up' in genus to check whether virtual knots are equivalent.

\begin{theorem}[Kuperberg's Theorem]
If $(K, \Sigma)$ and $(J, \Sigma)$ are two minimal genus representatives of the same virtual knot of virtual genus $v_{g}$, then they are equivalent as knots $\Sigma \times I$. That is, there is a self-homeomorphism $\varphi$ of $\Sigma \times I$ such that $\varphi(K) = J$.
\end{theorem}

However, as we illustrated in Fig.~\ref{fig:cellular-embedding-tricky}, the virtual genus of a virtual knot is not necessarily obvious, and furthermore, there is no known algorithm to compute it. The following theorem from \cite{parity-and-projection}, does allow for the computation of $g_{v}$ for low crossing numbers:

\begin{theorem}[Manturov]
	If a diagram of a knot $K$ in a thickened surface $\Sigma \times I$ contains the minimal number of crossings across all diagrams in thickened surfaces, then $\Sigma$ is the minimal genus surface that can support $K$. That is, the genus of $\Sigma$ is the knot's virtual genus.
\end{theorem}
In combination with Kuperberg's theorem, this says we also never need to go increase the genus of the supporting surface to reduce crossing number. It suffices to reduce the genus as much as possible, and then perform Reidemeister moves.


\section{Diagrams with Virtual Crossings}

We take a short detour to relate knots in thickened surfaces modulo stabilisation to an equivalent combinatorial definition of virtual knots. This is, in fact, the original formulation of virtual knots, due to Kauffman \cite{virtual-knot-theory}. Given a diagram of a knot $K$ on a surface $\Sigma$, we obtain a diagram of $K$ on the plane by embedding $\Sigma$ in $\R^{3}$ then projecting down to $\R^{2}$. Doing so creates a new type of crossing, which did not exist on $\Sigma$, but is an artefact of the projection. We call these crossings virtual crossings. Those crossings coming from a crossing on $\Sigma$, we call \textit{classical crossings}, and they have the usual over- and under- strands as determined by the projection. For strictly virtual knots these virtual crossings are necessary, as the knot diagram as a $4$-valent graph is not planar.

\begin{figure}[h!]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_1.pdf_tex}
		\caption{\textit{VR}I}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_2.pdf_tex}
		\caption{\textit{VR}II}
	\end{subfigure}
	\hspace*{\fill}
	\\
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_3.pdf_tex}
		\caption{\textit{VR}III}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.35 \textwidth}
		\centering
		\def\svgscale{0.22}
		\input{graphics/virtual_reidemeister_4.pdf_tex}
		\caption{\textit{VR}IV}
	\end{subfigure}
	\hspace*{\fill}
	\caption{The four additional virtual Reidemeister moves.}
	\label{fig:virtual-reidemeister-moves}
\end{figure}

The relevant equivalence relation on diagrams with virtual crossings are not hard to deduce. The three Reidemeister moves which hold between classical crossings, there are three corresponding with virtual crossings, and finally a `triangle move' that moves a `virtual strand' through a crossing. These additional moves are shown in Fig.~\ref{fig:virtual-reidemeister-moves}.

Classification efforts for virtual knots follow a similar strategy as for classical knots. The current best tabulation is by Jeremy Green \cite{virtual-knot-table}, up to 6 crossings. Green achieved this by computing all possible virtual knot diagrams up to $6$ crossings, determining which are equivalent via virtual Reidemeister moves, and then computing enough invariants distinguish all of these knots.

Since the virtual knot diagrams in Green's tabulation are by construction minimal crossing representations, by Manturov's theorem, this allows for the computation of virtual genus for all tabulated virtual knots. In Green's tabulation virtual knots are presented using yet another representation: Gauss codes. Gauss codes are a concise way of encoding the information of a virtual knot diagram in a discrete computationally useful format. We introduce them in Chapter 4.


\section{Annular Connected Sums and Prime Virtual Knots}
The rest of this chapter is aimed at constructing invariants of alternating virtual knots. We do this from the perspective of the lattices of integer flows of the Tait graphs of the virtual knot rather than equivalent $d$-invariant formulation of \cite{lattices-graphs-mutation}. But first we, introduce the tools used in Chapter 1 in the new virtual setting, starting with connected sums. We work with the definition of virtual knots as knots in thickened surfaces under stable equivalence.

We define connected sums for knots in thickened surfaces. We need to give a definition which plays well with stable equivalence, that is, connected sums of stabilised knots on thickened surfaces remain stabilised.

First, we must define connected sums for close orientable surfaces. The \textit{connected sum} of $\Sigma_{1}$ and $\Sigma_{2}$ is the surface $\Sigma_{1} \hash \Sigma_{2}$, obtained by removing a disk each from $\Sigma_{1}$ and $\Sigma_{2}$, then gluing together the resulting boundary circles. As this operation does not introduce or remove handles, $g(\Sigma_{1} \hash \Sigma_{2}) = g(\Sigma_{1}) + g(\Sigma_{2})$.

To define annular connected sums for surface knot diagrams, begin with the following: for $i \in \{1, 2\}$, a surface knot diagram $(D_{i}, \Sigma_{i})$ and representing knot $(K_{i}, \Sigma_{i})$ and a disk $B_{i}$ in $\Sigma_{i}$ that intersects $D_{i}$ transversely at two points, and $D_{i} \cap B_{i}$ is unknotted relative to $\partial B_{i}$ -- see Fig.~\ref{fig:annular-connected-sum}. Then, the \textit{annular connected sum} $(D, \Sigma) = (D_{1}, \Sigma_{1}) \hash_{B_{1}, B_{2}} (D_{2}, \Sigma_{2})$ is constructed by gluing $B_{1}$ and $B_{2}$ such that the two element set $\partial B_{1} \cup D_{1}$ is glued to an element of $\partial B_{2} \cap D_{2}$.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.6}
	\input{graphics/annular_connect_sum.pdf_tex}
	
	\caption{A (but not the only) example of an annular connected sum of $(K_{1}, \Sigma_{1})$ and $(K_{2}, \Sigma_{2})$ with respect to the diagrams $(D_{1}, \Sigma_{1})$ and $(D_{2}, \Sigma_{2})$ shown. The knots in thickened surfaces are representatives of virtual knots $3_{7}$ and $2_{1}$.}
	\label{fig:annular-connected-sum}
\end{figure}

We say that $(K, \Sigma) = (K_{1}, \Sigma_{1}) \hash (K_{2}, \Sigma_{2})$. Unlike in the classical case, this is not in general well-defined \cite{virtual-knots-and-links}, and depends on both the surface diagrams for $K_{1}$ and $K_{2}$ and the chosen disks. However, if $\Sigma_{1} = \Sigma_{2} = \S^{2}$, then this definition is equivalent to the connected sum of classical knots, and well-defined. In general, we write $(K_{1}, \Sigma_{1}) \hash (K_{2}, \Sigma_{2})$ for any of the annular connected sums of $(K_{1}, \Sigma_{1})$ and $(K_{2}, \Sigma_{2})$.

An annular connected sum where one of the summands is the unknot in $\S^{2} \times I$ the sum is said to be \textit{trivial}. A knot in a thickened surface is \textit{prime} if it is not the non-trivial annular connected sum of any two knots in thickened surfaces.

The \textit{connected sum} of two virtual knots is the annular connected sum of their surface diagram. This again depends both on the representatives and the disks chosen in the annular connected su,.

A connected sum of virtual knots $V = V_{1} \hash V_{2}$ is \textit{trivial} if one of the summands is in the stable equivalence class of the unknot in $S^{2} \times I$, and the other is equivalent to $V$. A virtual knot (other than the trivial knot) is \textit{prime} if there is no way to write it as a non-trivial connected sum.

Despite the ill-defined nature of the annular connected sum, the decomposition of virtual knots into their constituent primes behaves in a nice way on a certain subset of all virtual knots. The theorem analogous to Schubert's theorem in the virtual setting is a result of Matveev \cite[Theorem 13]{roots-and-decompositions}.

\begin{theorem}[Matveev's Theorem]
Any virtual knot can be decomposed into a connected sum of prime and trivial virtual knots. The prime summands in this decomposition are determined uniquely, that is, depend only on the initial virtual knot.
\end{theorem}

There is also a notion of \textit{weakly prime} virtual knots which cannot be decomposed as a connected sum of one virtual and one classical knot. The formal definition is given by Howie-Purcell \cite{geometry-of-alternating-links-on-surfaces}.


\section{Alternating Virtual Knots and Virtual Knot Mutation}
A famous theorem Seifert in classical knot theory states that It is always possible to find some orientable surface $S \subseteq \R^{3}$ called the Seifert surface, such that $\partial S = K$.There is a vast amount of theory that springs from this fact, and Chapters 3 and 4 will examine a generalisation of a small amount of this. Virtual knots which do possess Seifert surfaces behave so classically that they are called \textit{almost classical}, but only a small fraction of strictly virtual knots have this property.

For virtual knots, is is not usually possible to find such a surface inside $\Sigma \times I$. Indeed typically it is not even possible to find a non-orientable surface with boundary $V$. Those virtual knots for which this is possible are exactly those that are $\Z_{2}$-null-homologous, and we will look at these in the next section. A further subset of these knots are \textit{alternating}, where alternating has the same definition as in the classical case. In fact, in Chapter $3$, we will give a completely geometric characterisation of alternating virtual knots in terms of positive and negative definite spanning surfaces.

Alternating knots are also important because virtual analogues of the Tait conjectures hold. The first Tait conjecture was recently proven for virtual knots by Karimi \cite[Theorem 1.6]{alternating-virtual-knots}:

\begin{theorem}[First Tait Conjecture for Virtual Knots]
Let $D$ be a reduced alternating knot diagram for a virtual knot $V$. Then $D$ has minimal crossing number.
\end{theorem}

Very recent work of Kindred also shows that for weakly prime virtual knots the third Tait conjecture holds \cite[Theorem 4.18]{virtual-flyping-theorem}:

\begin{theorem}[Virtual Flyping Theorem]
Let $(K, \Sigma)$ be a knot in a thickened surface. Let $D$ and $E$ be weakly prime, alternating, cellularly embedded surface diagrams of $K$. Then $D$ and $E$ are related by a sequence of flypes on $\Sigma$.
\end{theorem}

There are two types of mutation of virtual knots: disk mutation and surface mutation. \textit{Disk mutation} is directly analogous to mutation of classical knots: take a disk $D \subseteq \Sigma$ which contains a tangle and flip or rotate it, the resulting knot is a disk mutant of the original. This is in contrast to \textit{surface mutation}, in which the chosen subsurface need only have circular boundary, but could contain handles. Surface mutation is a more invasive operation and we do not consider it in the present text. However, future work may lie in investigating the equivalence classes generated by surface mutation. For the rest of this text, mutation, in the virtual context, refers to disk mutation.

\section{Checkerboard Colourings and Tait Graphs of Virtual Knots}

Recall that in the classical case, all knots are checkerboard colourable, so there is no obstruction to producing Tait graphs. Furthermore, only one Tait graph is necessary to encode an alternating knot, as the two Tait graphs are planar duals to each other. We will see that the virtual case is more subtle.

Not all surface knot diagrams are checkerboard colourable. Worse, any checkerboard colourable diagram on a surface $\Sigma$ can be made non-checkerboard colourable by adding a handle: see Fig.~\ref{fig:adding-handle-to-4-105}. Adding a handle between a black region and a white region creates a region needing to be both black and white, so the diagram on the stabilised surface is not checkerboard colourable.

\begin{figure}[hbt]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/4-105_vknot_checker.pdf_tex}
		\caption{Virtual knot $4_{105}$}
		\label{fig:4-105-vknot}
	\end{subfigure}
	\hspace*{\fill}	\hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/4-105_vknot_handle.pdf_tex}
		\caption{A handle is added}
		\label{fig:4-105-vknot-with-handle}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{Adding a handle can disrupt checkerboard colourability.}
	\label{fig:adding-handle-to-4-105}
\end{figure}

We say a knot in a given thickened surface $\Sigma \times I$ is \textit{checkerboard colourable} if there exists a checkerboard colourable surface knot diagram on $\Sigma$ that represents it. We have the following classification of checkerboard colourable knots in thickened surfaces \cite{minimal-diagrams-surface-links}:

\begin{theorem}
Given a knot in a thickened surface, $K \subset \Sigma \times I$, the following are equivalent:
	\begin{enumerate}[(i)]
	\item $K$ is checkerboard colourable,
	\item $K$ is the boundary of an unoriented spanning surface $F \subset \Sigma \times I$,
	\item $[K] = 0$ in the homology group $H_{1}(\Sigma \times I; \Z_{2})$.
	\end{enumerate} 
\end{theorem}

Likewise, we say a virtual knot is \textit{checkerboard colourable} if there is a representative that is checkerboard colourable. Note that while the knot in a Fig.~\ref{fig:4-105-vknot-with-handle} isn't checkerboard colourable as a knot in a $2\T^{2} \times I$, it is indeed checkerboard colourable as a virtual knot, as after destabilisation we have the knot in Fig.~\ref{fig:4-105-vknot}. Not every virtual knot is checkerboard colourable, even on its surface of minimal genus: see Fig.~\ref{fig:cc-of-vknots}.

\begin{figure}[hbt!]
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/2-1_vknot.pdf_tex}
		\caption{Virtual knot $2_{1}$.}
		\label{fig:non-cc-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/3-7_vknot.pdf_tex}
		\caption{Virtual knot $3_{7}$.}
		\label{fig:cc-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\caption{Two virtual knots on their surfaces of minimal genus. The knot $2_{1}$ is not checkerboard colourable in the given diagram. In fact $2_{1}$ is not checkerboard colourable at all, as $[K] \neq 0$ in $H_{1}(\Sigma \times I; \Z_{2})$. The knot $3_{7}$ is checkerboard colourable.}
	\label{fig:cc-of-vknots}
\end{figure}

For the purposes of generalising the lattice of integer flows of the Tait graph, we need only concern ourselves with alternating virtual knots -- those virtual knots that can be represented by alternating virtual knot diagrams. Fortunately, tanks to the following theorem will not run into any trouble \cite[Lemma 7]{jones-polynomial-checkerboard-colourable}.

\begin{theorem}[Kamada's Lemma]
	Every alternating virtual knot is checkerboard colourable.
\end{theorem}

Furthermore, just as in the classical case, alternating surface knot diagrams have the property that when checkerboard coloured, all crossings have the same type \cite[Lemma 6]{alternating-links-thickened-surfaces}. Again, the convention is to choose the checkerboard colouring such that all crossings are type A (see Fig.~\ref{fig:crossing-type}).

For those surface knot diagrams that are checkerboard colourable, we can define the Tait graphs of the knot. In the classical case, these were planar graphs, or more specifically planar embedded graphs. In the virtual context, they are surface embeddings.

% TODO: Zsuzsi check.
Let $G$ be a connected graph. A \textit{surface embedding} of $G$ is a map $i: G \inject \Sigma$, considered up to orientation-preserving diffeomorphism. To simplify notation, we use $G$ and $i(G)$ interchangeably.

One way to uniquely determine a surface embedding for $G$ is to specify around each vertex of $G$, a cyclic order for the incident edges \cite[Theorem 3.2.4]{graphs-on-surfaces}. This extra information is called a \textit{rotation system}; a graph with a rotation system is also called a \textit{ribbon graph} or \textit{fat graph}.

\notered{example and figures?}

The \textit{surface dual} of the cellularly embedded surface embedding $i: G \inject \Sigma$ is another surface embedding $i^{*}: G^{*} \inject \Sigma$, where $G^{*}$ is the graph that has a vertex for every connected component of  $\Sigma \smallsetminus G$, and for each edge $e$ of $G$, a dual edge $e^{\ast}$ connecting the vertices lying on either side of $e$. The map $J$ then assigns vertices and edges of $G^{*}$ to the correct place in $\Sigma$. The requirement that $G$ be cellularly embedded is necessary for the surface dual to be well-defined. For example, without this requirement, Fig.~\ref{fig:multiple_dual_graphs} contains two distinct surface duals of the same surface embedding.

\begin{figure}[hbt!]
	\centering
	\def\svgscale{0.45}
	\input{graphics/multiple_dual_graphs.pdf_tex}
	
	\caption{These two red graphs are both surface dual to the same non cellularly-embedded black surface embedding. However, they are not equivalent up to diffeomorphism, in fact a Dehn twist is required to go between them.}
	\label{fig:multiple_dual_graphs}
\end{figure}


We present here a few elementary results about surface duals.

\begin{lemma}
Let $G$ be cellularly embedded, so that $G^{*}$ is defined. Then $G^{*}$ is cellularly embedded.
\end{lemma}

\begin{proof}
Since $G$ is cellularly embedded in $\Sigma$, the Euler characteristic $\chi(\Sigma) = |V(G)| - |E(G)| + |F(G)|$. From the definition of the surface dual, $|V(G^{*})| = |F(G)|$ and $|E(G^{*})| = |E(G)|$. Now let $v$ denote an arbitrary vertex of $G$. Consider the set of edges dual to the edges incident to $v$. This forms a cycle in $G^{*}$ which separates $v$ from all other vertices. Since there are no other edges inside this cycle, it is a face containing only the vertex $v$. Hence, $|F(G^{*})| \leq |V(G)|$. Conversely each connected component of $\Sigma \smallsetminus G^{*}$ is bounded by a cycle of at least one edge, $e^{*}$. The edge $e$ dual to $e^{*}$ terminated within the connected component $\Sigma \smallsetminus G^{*}$, so this component or `face' must contain a vertex, so $|F(G^{*})| \geq |V(G)|$. Hence, the Euler characteristic $\chi(G^{*}) = \chi(G)$, so $G^{*}$ is also cellularly embedded.
\end{proof}

\begin{corollary}
Let $G$ be cellularly embedded, so that $G^{*}$ is defined. Then $G^{**} = G$.
\end{corollary}

\notered{Show that we can reconstruct the knot from the Tait graphs, like in the classical case. This is no longer unique. Mention here and give example.}

\section{The Lattice of Integer Flows for Virtual Knots}

This section will be dedicated to asking whether the results about the lattice of integer flows in the classical case generalise to the virtual setting. Like the classical case, we will find that the lattice of integer flows of either Tait graph of a virtual knot is an invariant of alternating virtual knots. However, we will not be able to show that this is a \textit{complete} invariant of alternating virtual knots. In fact, in Chapter 5, we will produce a counterexample to this statement.

As the lattice of integer flows is defined graph-theoretically, the same definition applies in the virtual setting. The difference is that the graph embeddings are no longer planar duals, but surface duals. As a result, the lattice of integer flows of the white Tait graph is no longer isomorphic to the lattice of integer cuts of the black Tait graph, so both $\Lambda_{B}(D)$ and $\Lambda_{W}(D)$ are needed not to unnecessarily lose information about the knot. We present the following example to show this.

Let $K = 5_{2429}$, and $D$ the surface knot diagram given in Fig.~\ref{fig:5-2429-vknot}. The Tait graphs are given abstractly in Fig.~\ref{fig:5-2429-taits-abstract}.

\begin{figure}[hbt]
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/5-2429_cc.pdf_tex}
		\caption{Virtual knot $5_{2429}$\ldots}
		\label{fig:5-2429-vknot}
	\end{subfigure}
	\hspace*{\fill}
	\begin{subfigure}[b]{0.45 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/5-2429_taits.pdf_tex}
		\caption{\ldots with Tait graphs.}
		\label{fig:5-2429-taits}
	\end{subfigure}
	\hspace*{\fill}
	\caption{}
	\label{fig:5-2429-example}
\end{figure}

\begin{figure}[hbt]
	\centering
	\def\svgscale{0.4}
	\input{graphics/5-2429_taits_abstract.pdf_tex}
	\caption{The Tait graphs $G_{B}(D)$ and $G_{W}(D)$.}
	\label{fig:5-2429-taits-abstract}
\end{figure}

With respect to the basis $(e_{1} + e_{2} + e_{3}, e_{4} + e_{5})$, the inner product on $\Lambda_{B}(K)$ has Gram matrix
\[\begin{bmatrix}
3 & 0 \\
0 & 3
\end{bmatrix}\,.\]
Likewise with respect to the basis $(f_{1}, f_{2}, f_{3}, f_{4}, f_{5})$, $\Lambda_{W}(K)$ has Gram matrix
\[\begin{bmatrix}
1 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 1\\
\end{bmatrix}\,.\]

Again, these are only determined by the lattices up to unimodular congruence.

In the classical case, we proved that $\Lambda_{B}(D)$ and $\Lambda_{W}(D)$ were invariants of alternating knots as follows. We used the flyping theorem to relate any prime alternating diagrams via a sequence of flypes. Then, by the lemma that flypes correspond to Whitney flips of the Tait graph, any two prime alternating diagrams of the same knot have isomorphic lattices. Finally we use a series of results to extend this from prime alternating knots to arbitrary alternating knots, including Menasco's theorem and the unique decomposition theorem (Schubert's theorem) for knots.

The virtual case is more complicated. Kindred's virtual flyping theorem applies only to weakly prime alternating knots, and the annular connected sum of virtual knots is a multivalued operation. However there are virtual analogues of each of the results used in the classical proof. An analogous, diagrammatic proof of this statement is the work of the author along with collaborators Hans Boden, Zsuzsanna Dancso and Tilda Wilkinson-Finch will appear in a paper which is currently in draft form.

However in the current text, we give a topological proof by showing that the lattice of integer flows of the Tait graph is equivalent to the topologically defined Gordon-Litherland linking form of Chapter 3. We state this now, but delay the proof until then.

\begin{theorem}
Let $V$ be an alternating virtual knot, and let $D$, $E$ be alternating surface knot diagrams for $V$. Then $\Lambda_{B}(D) \cong \Lambda_{B}(E)$ and $\Lambda_{B}(D) \cong \Lambda_{W}(E)$.
\end{theorem}

Unlike the classical case, $\Lambda_{B}(V)$ and $\Lambda_{W}(V)$ are not equivalent, as this came from the fact that in the plane, the lattice of integer flows of a graph $G$ was isomorphic to the lattice of integer cuts of $G$. This is only true on the plane.

Two statements from the classical case remain to be examined: that $\Lambda_{B}(V)$ (resp. $\Lambda_{W}(V)$) is a mutation invariant, and that $\Lambda_{B}(V)$ (resp. $\Lambda_{W}(V)$) is complete up to mutation.

The first statement holds in the general setting.
\begin{theorem}
Let $V_{1}$ and $V_{2}$ be alternating knots that are mutants. Then $\Lambda_{B}(V_{1}) \cong \Lambda_{B}(V_{2})$ and $\Lambda_{W}(V_{1}) \cong \Lambda_{W}(V_{2})$.
\end{theorem}
\begin{proof}
The proof follows the proof in the classical case exactly. Let $V_{1}$ and $V_{2}$ be mutants. There is a sequence of mutations from $V_{1}$ to $V_{2}$. The lemma from Chapter 1 that a flype move induces a Whitney flip of the Tait graph generalises directly to disk mutation. Thus, their Tait graphs are related by Whitney flips. By Whitney's theorem, the graphs are $2$-isomorphic, and since $\Lambda_{B}(K)$ (resp. $\Lambda_{W}(K)$) is a $2$-isomorphism invariant, we have $\Lambda_{B}(V_{1}) \cong \Lambda_{B}(V_{2})$ (resp. $\Lambda_{W}(V_{1}) \cong \Lambda_{W}(V_{2})$).
\end{proof}

Unlike in the the above proof, the proof that $\Lambda_{B}(K)$ and $\Lambda_{W}(K)$ are complete up to mutation does not generalise. \notered{Insert Zsuzsi's argument as to why.} In fact, on the class of virtual knots, even the pair of $\Lambda_{B}(K)$ and $\Lambda_{W}(K)$ is incomplete.

\begin{theorem}
The pair of lattices of integer flows of the Tait graphs of virtual knots, $(\Lambda_{B}(V), \Lambda_{W}(V))$ is not a complete invariant of alternating virtual knots.
\end{theorem}

The rest of this text will work up to the proof of this theorem. Chapter 3 will introduce the Gordon-Litherland linking form, another mutation invariant of virtual knots whose symmetrisation is equivalent to the lattice of integer flows. Chapters 4 and 5 will present algorithms which we use to compute these invariants, which will produce the necessary counterexample.


\chapter{Gordon-Litherland Linking Forms}

\epigraph{\itshape God created the knots. All else in topology is the work of mortals.}{--- Leopold Kronecker, modified by Dror Bar-Natan}

% TODO: This is funny right?
We turn our attention to the work of Cameron Gordon and Richard Litherland, and quietly note that Gordon (1945 -- present) may yet disprove the conjecture in this Chapter's epigraph. This duo assigned a symmetric quadratic form to a knot, based on an unoriented spanning surface of the knot \cite{signature-of-a-link}. Recent work by Boden-Chrisman-Karmimi extends this to the virtual setting by generalising this to a quadratic form for knots in thickened surfaces, called the Gordon-Litherland linking form \cite{gordon-litherland-pairing-thickened-surfaces}. In this chapter, we will define this linking form, prove that it is a mutation invariant of alternating virtual knots, and relate it with the lattice of integer flows of the previous chapter.

The first three sections closely follow \cite{gordon-litherland-pairing-thickened-surfaces, alternating-links-thickened-surfaces, mock-seifert-matrices} to describe the Gordon-Litherland form.

\section{Spanning Surfaces and Linking Numbers}

A \textit{spanning surface} of a knot (in a thickened surface) $K$ is an unoriented surface $S \subset \R^{3}$ ($S \subset \Sigma \times I$) with boundary $\partial S = K$. The definition of the Gordon-Litherland linking form is based on the spanning surface of a knot. Recall the theorem in Chapter 2 that equates a knot in a thickened surface being checkerboard colourable with the existence of a spanning surface. Hence, while all classical knots have spanning surfaces, the same is not true in thickened surfaces.

From the checkerboard colouring of a knot in $\Sigma \times I$, it is easy to construct a spanning surface. For each coloured region of the surface knot diagram $D$, we place a corresponding disk in $\Sigma \times \{1/2\}$. For each crossing in $D$, we place a half-twisted band connecting the two adjacent coloured regions, such that the half-twist in the band agrees with the type of the crossing. Fig.~\ref{fig:crossing-type} illustrates this well. We denote this spanning surface $F$, and the surface obtained by swapping the colourings as $F^{*}$. Observe that $F \cup F^{*} = \Sigma$.

Let $J$ and $K$ be two oriented disjoint simple closed curves in the interior of $\Sigma \times I$. Consider the relative homology group $H_{1}(\Sigma \times I \smallsetminus J, \Sigma \times \{1\})$. This group is isomorphic to $\Z$, and generated by a meridian $\mu$ of $J$ \cite{virtual-knot-groups-almost-classical-knots}. The \textit{linking number} of $J$ with $K$, $\lk(J, K)$ is defined as the unique integer $n$ such that $[K] = n\mu$. This serves to define $\lk(J, K)$ as the signed number of times that $J$ passes above $K$, with `above' defined to be with respect to $t$, the parameter of the interval $I$. A positive (resp. negative) contribution being made to $\lk(J, K)$ when $J$ passes over $K$ such that the coordinate system $\hat{j}, \hat{k}, \hat{t}$ has a positive (negative) orientation.

Note that $\lk(J, K)$ is independent of the number of times that $J$ passes under $K$: this is instead captured by $\lk(K, J)$.

The linking numbers of curves in $\R^{2} \times I$ are symmetric:
\[\lk(J, K) - \lk(K, J) = 0\]
this can be shown by examining the following table of linking numbers and noticing that when $K$ passes over or under $J$ going `up' (with respect to the page) there is a positive contribution to $\lk(J, K) - \lk(K, J)$, and likewise a negative contribution when $K$ passes over or under $J$ going `down'. An application of the Jordan curve theorem proves this.

\begin{table}[h]
\centering
\begin{tabular}{ c | c | c @{\hspace{10pt}}||@{\hspace{10pt}} c | c | c}
	Crossing	& $\lk(J, K)$ & $-\lk(K, J)$ & Crossing	& $\lk(J, K)$ & $-\lk(K, J)$ \\ \hline
	\def\svgscale{0.18}\input{graphics/linking_diagram_1.pdf_tex} & +1 & 0 & \def\svgscale{0.18}\input{graphics/linking_diagram_3.pdf_tex} & 0 & +1 \\ \hline
	\def\svgscale{0.18}\input{graphics/linking_diagram_2.pdf_tex} & -1 & 0 & \def\svgscale{0.18}\input{graphics/linking_diagram_4.pdf_tex} & 0 & -1 \\
\end{tabular}
	\caption{Possibilities for how $J$ may pass over $K$ or vice versa and their contribution to $\lk(J, K) - \lk(K, J)$. In each diagram, $J$ is red, and $K$ is blue.}
	\label{tab:linking-number-crossings}
\end{table}

The \textit{algebraic intersection number} of two homology classes $\alpha$ and $\beta$ is the number of times any two elements of those classes intersect, counted with sign (specifically, the sign of the coordinate system $\hat{a}, \hat{b}$ where $a$ and $b$ are two $1$-chains). This is well-defined, as if $a$ and $a'$ are such that $[a] = [a']$, then $[a - a'] = 0$, so there is a $2$-chain $A$ such that $\partial A = a - a'$. But the intersection number of a closed curve with any $2$-chain is $0$, so $A \cdot b = 0$, hence $(a - a') \cdot b = 0$, and finally $a \cdot b = a' \cdot b$.

In general in $\Sigma \times I$, linking numbers are not symmetric. Rather, they satisfy the following relationship:
\[\lk(J, K) - \lk(K, J) = p_{*}(J) \cdot p_{*}(K)\,,\]
where $p: \Sigma \times I \longrightarrow \Sigma$ is the projection map which induces $p_{*}: H_{1}(\Sigma \times I) \to H_{1}(\Sigma)$. The product $\cdot$ here is 
The proof of this fact is an easy modification of the argument above.

Consider the spanning surface of a knot, $F$. We consider this unoriented, but depending on the knot, this may or may not be orientable. Either way, we can construct an oriented double-cover like so. Take the normal bundle $N(F)$. We set $\widetilde{F}$ as the boundary of $N(F)$, a $\{0, 1\}$-bundle of $F$. This $\widetilde{F}$ is a double cover of $F$, and we take $\pi: \widetilde{F} \longrightarrow F$ to be the covering map. If $F$ was orientable, then this double cover is the trivial $2$-sheeted double cover (and hence orientable), and if $F$ was non-orientable, then this is the orientable double cover of $F$. Either way, $\widetilde{F}$ is orientable, and by our definition oriented.

The \textit{pushoff} of a closed loop $\gamma$ in $F$ is $\pi^{-1}(\gamma)$. If $F$ was orientable, this is a union of two closed curves, one above $\gamma$ and one below, whereas if $F$ was non-orientable, this is a single closed curve that passes both above and below $\gamma$. We define the \textit{transfer map} $\tau: H_{1}(F) \longrightarrow H_{1}(\widetilde{F})$ by $\tau([a]) = [\pi^{-1}(a)]$. Locally, we can also define $t^{+}$ and $t^{-}$ as the two maps $t^{\pm}: F \longrightarrow \widetilde{F}$. This way, locally composing a curve $\gamma$ with $t^{+}$ or $t^{-}$ produces a lift of $\gamma$. We define $t(\gamma) = t^{+}(\gamma) \cup t^{-}(\gamma)$.

\section{The Linking Form}
The \textit{Gordon-Litherland linking form} (which we shorten to the \textit{linking form}) on a compact, unoriented spanning surface $F$ of a knot in $\Sigma_{1} \times I$ is the bilinear form
\[\mathcal{L}_{F}: H_{1}(F) \times H_{1}(F) \longrightarrow \Z\]
defined by
\[\mathcal{L}_{F}(\alpha, \beta) = \lk(\tau\alpha, \beta)\]
for $\alpha, \beta \in H_{1}(F)$. That this is well-defined is an easy exercise and shown in \cite[Chapter 2]{alternating-links-thickened-surfaces}. 

With respect to a basis of $H_{1}(F)$, we can write this as a matrix. An integral matrix is said to be a \textit{mock Seifert matrix} if its $ij$ entry is $\lk(\tau \alpha_{i}, \alpha_{j})$ for some basis $\{\alpha_{1}, \dots, \alpha_{n}\}$ of $H_{1}(F)$. The word \textit{mock} here refers to the fact that unlike a usual Seifert matrix, the surface $F$ is not a necessarily orientable. Such a spanning surface would be called a Seifert surface. As this matrix represents the bilinear form $\mathcal{L}_{F}$ with respect to some basis, any other unimodular congruent matrix represents the same $\mathcal{L}_{F}$ with respect to a different basis, and conversely any change of basis induces a unimodular congruence in a mock Seifert matrix.

We wait until Chapter $4$ to give examples of computations of this form, as that will be the primary focus of the chapter.

As observed in \cite[Section 3]{gordon-litherland-pairing-thickened-surfaces}, the linking forms corresponding to the black and white checkerboard surfaces of the knot defines an invariant of checkerboard colourable knots, so long as computations are done on a minimal genus representative. As reduced, cellularly embedded alternating diagrams of alternating knots are always minimal genus, we have the following special case.

\begin{theorem}
Let $V$ be an alternating virtual knot, and let $D$ and $E$ be reduced, alternating cellularly embedded diagrams of $V$. Let $F(D)$ and $F(E)$ be the spanning surfaces corresponding to the black regions of $D$ and $E$ respectively. Similarly, let $F^{*}(D)$ and $F^{*}(E)$ be those corresponding to the white regions. Then $\mathcal{L}_{F(D)} \cong \mathcal{L}_{F(E)}$ and $\mathcal{L}_{F^{*}(D)} \cong \mathcal{L}_{F^{*}(E)}$.
\end{theorem}

\begin{proof}
	content...
\end{proof}

The Gordon-Litherland pairing is also a mutation invariant.

\begin{theorem}
Let $D$ and $E$ be surface knot diagrams related by a sequence of disk mutations. Then with the notation above $\mathcal{L}_{F(D)} \cong \mathcal{L}_{F(E)}$ and $\mathcal{L}_{F^{*}(D)} \cong \mathcal{L}_{F^{*}(E)}$.
\end{theorem}

\begin{proof}
\notered{I know how to prove this now.}
\end{proof}

\section{The Gordon-Litherland Pairing}

The \textit{Gordon-Litherland pairing} on a compact, unoriented spanning surface $F$ of a knot in $\Sigma \times I$ is the symmetric bilinear form
\[\mathcal{G}_{F}: H_{1}(F) \times H_{1}(F) \longrightarrow \Z\]
given by the symmetrisation of the linking form:
\[\mathcal{G}_{F}(\alpha, \beta) = \dfrac{1}{2}(\lk(\tau \alpha, \beta) + \lk(\tau\beta, \alpha))\,.\]

If a mock Seifert matrix $A$ represents $\mathcal{L}_{F}$ with respect to some basis of $H_{1}(F)$, then its symmetrisation $\frac{1}{2}(A + A^{T})$ represents the pairing $\mathcal{G}_{F}$ with respect to the same basis.

Gordon-Litherland and Boden-Karimi-Chrisman use the Gordon-Litherland pairing to define a set of link invariants based on this form, including the signature, determinant, nullity of a link.

From the fact that linking forms $\mathcal{L}_{F}$ and $\mathcal{L}_{F^{*}}$ are mutation invariants of alternating knots, it follows that the pairing is as well. In fact, the Gordon-Litherland pairing is exactly the lattice of integer flows.

\begin{theorem}
Let $K$ be an alternating virtual knot. The Gordon-Litherland pairing on the black surface  is equal to the lattice of integer flows of the Tait graph corresponding to the black surface: $\mathcal{G}_{F}(K) \cong \Lambda_{B}(K)$. Similarly, $\mathcal{G}_{F^{*}}(K) \cong -\Lambda_{W}(K)$.
\end{theorem}

\begin{proof}
First note that the black spanning surface $F$ deformation-retracts to the Tait graph corresponding to the black region, $G_{B}$ so $H_{1}(F) \cong H_{1}(G_{B})$. Hence all that we need is to check that the pairing is the same.

Let $\alpha, \beta$ be basis elements of $H_{1}(F)$, and choose representative curves $a$ and $b$ for $\alpha$ and $\beta$ respectively. The curves can be deformed by homotopy such that when projected onto $\Sigma$, they only touch at crossings, so we only need to look at the local contribution at the crossings:
\[\dfrac{1}{2} \left( \lk(t a, b) + \lk(t b, a) \right)\,.\]

We see that the local contribution at a crossing is $1$ if $a$ and $b$ pass through the crossing in the same direction. By symmetry, the order of the curves doesn't matters, so there are only two cases to examine: where the curves intersect tangentially in the projection, and the other where they intersect transversely. The tangential case is shown in Fig.~\ref{fig:gordon-litherland-pairing-example}. A similar argument shows that when $a$ and $b$ intersect transversely in the projection, the local contribution to $\mathcal{G}_{F}(\alpha, \beta)$ is also $1$. Obviously if $\alpha$ and $\beta$ don't both pass through a crossing, then the local contribution from that crossing is 0.

By linearity, when the curves pass through the crossing in opposite directions, the local contribution to $\mathcal{G}_{F}(\alpha, \beta)$ is $-1$.

\begin{figure}[h!]
	\centering
	\def\svgscale{0.54}
	\input{graphics/gordon_litherland_pairing_example.pdf_tex}
	
	\caption{A local contribution to $\mathcal{G}_{F}(\alpha, \beta)$ from the curves $a$ and $b$. The left shows the initial geometry of $a$ and $b$. The middle and right images illustrate that $\lk(ta, b) = 1$ and $\lk(tb, a) = 1$.}
	\label{fig:gordon-litherland-pairing-example}
\end{figure}

Via the identification $H_{1}(F) \cong H_{1}(G_{B})$, the curves correspond to cycles in the Tait graph whose edges are identified with the crossings. Therefore, this inner product counts with sign, the common edges between cycles of $G_{B}$. This is by definition the inner product on the lattice of integer flows of $G_{B}$.

The same argument applies for the white checkerboard surface, but since the crossings are now of opposite type, we get opposite sign local contributions to $\mathcal{G}_{F^{*}}(\alpha, \beta)$ in each case. Hence, $\mathcal{G}_{F^{*}}(K) \cong -\Lambda_{W}(K)$.


\end{proof}

\chapter{Computing Mock Seifert Matrices}

\epigraph{In these days the angel of topology and the devil of algebra fight for the soul of each individual mathematical domain.}{--- Hermann Weyl, \textit{Invariants}}

\epigraph{Better to reign in Hell than to serve in Heaven.}{--- John Milton, \textit{Paradise Lost}}

In this Chapter, we present an algorithm to compute a pair of mock Seifert matrices for a virtual knot from its Gauss code. This algorithm has been implemented to compare the linking forms of many alternating virtual knots. The result of these computations is a pair of virtual knots which are not mutants, but have isomorphic Gordon-Litherland pairings. This provides a counterexample to the completeness of the lattice of integer flows of the Tait graph in the virtual setting. Finally, we present a note on some invariants of unimodular congruence that was observed by the author.

\section{Gauss Codes}

Knot diagrams, being geometrical objects are difficult to make computations with directly. The \textit{Gauss code} of an oriented knot diagram encodes combinatorial information about the order in which the crossings are visited, as the knot diagram is traversed. It is a sequence of crossings (usually given by labels $\{1, \cdots, n\}$), along with a sign or symbol determining whether a crossing is traversed via the over-strand or the under-strand. This is, of course, only unique up to cyclic permutation. For example, the diagram of the figure-8 knot in Figure \ref{fig:figure_8} has Gauss code
\[\text{\ttfamily 1O,\ 2U,\ 4O,\ 3U,\ 2O,\ 1U,\ 3O,\ 4U}\,.\]
Every knot has a Gauss code, but not every Gauss code corresponds to a knot, as a Gauss code may give rise to a graph that is non-planar and hence could only be realised as a knot with the addition of words to the Gauss code.

The Gauss code can be extended to incorporate the writhe, also known as the sign, of each crossing, and in doing so, each element of the sequence also incorporates a sign of $+1$ for a positive crossing, or $-1$ for a negative crossing. From henceforth we only refer to the extended Gauss code simply as the Gauss code. In the example given in Figure \ref{fig:figure_8}, the extended Gauss code is 
\[\text{\ttfamily-1O,\ -2U,\ +4O,\ +3U,\ -2O,\ -1U,\ +3O,\ +4U}\,,\]
since crossings $1$ and $2$ are negative, and crossings $3$ and $4$ are positive.

The Gauss code is particularly convenient to extend to virtual knots, as it takes into account only combinatorial information about the crossings, and is oblivious to the diagram's planarity (or lack thereof). In the Gauss code of a virtual knot, virtual crossings make no contribution. By this generalisation, every Gauss code corresponds to a virtual knot, as we can always resolve non-planarity in the diagram by adding virtual crossings, or equivalently moving to a surface of greater genus.

\section{Reconstructing the Tait Graph}

\notered{Add figures to this section.}

It is always possible to construct the Tait graphs of a checkerboard colourable virtual knot from its Gauss code, and since the $d$-invariant is computable from the Tait graphs, this gives a method of computing the $d$-invariant directly from the Gauss code. We now outline an algorithm by which the Gauss code of a knot can be used to compute its $d$-invariant. The algorithm has two main steps; we first compute the Tait graph of the knot from its Gauss code, then compute the $d$-invariant from the Tait graph.

We begin with the Gauss code for some checker-board colourable knot diagram, which induces an orientation on the knot diagram. Though we do not have the diagram itself, it is possible to reconstruct its Tait graph.
	
	The idea of the algorithm is as follows. Edges in the Tait graph, are given by faces in the diagram. To find these faces, we traverse the knot, but each time we encounter a crossing, we `jump' to the other strand and continue our traversal, always making sure to turn in the same direction (left or right). We then complete the Tait graph by inserting edges between vertices where the corresponding faces touch diagonally at a crossing.
	
	To illustrate the algorithm, we present it alongside an example Gauss code of a virtual knot,
	\[-1o,\ -2u,\ -3o,\ -1u,\ +4o,\ -3u,\ -2o,\ +4u\,.\]
	For illustrative purposes, we provide the diagram of the knot from which the above Gauss code was taken in Figure \ref{fig:knot_and_cd_v_4-106}, though it is important to note we will not have this information when computing the knot from the Gauss code. By an arc, we mean a path in the knot diagram between exactly two adjacent crossings (crossings with no intermediate crossings in the traversal).
	
	\notered{Virtual Knot Diagram $4_{106}$}
		
	The Gauss diagram of a knot (with $n$ crossings) consists of a cyclic ordering of the $2n$ words of the Gauss code around the circle, with directed edges (chords) connecting two words of the same crossing, oriented from the over word to the under word. These chords which represent crossings, are labelled according to the crossing's sign. Arcs on the diagram between words represent arcs on the knot diagram.
	
	This algorithm iterates over the faces in the knot diagram, so we maintain a counter, $f$, of the face presently being examined and start by setting $f = 0$. We wish to explore this face by always turning the same direction at the end of each arc. However the natural variable to control when traversing the Gauss diagram is the alignment of the traversal direction with the orientation on the knot, defined as
	\[a = \begin{cases}
		-1 & \text{iff traversing clockwise (aligned with orientation)} \\
		+1 & \text{iff traversing anti-clockwise (anti-aligned with orientation)}\,.
	\end{cases}\] Hence we choose an arbitrary  turn-direction of left or right and control the alignment such that this turn-direction is fixed. The turn-direction is represented by the variable $t$ with
	\[t = \begin{cases}
		-1	& \text{for left turn}\\
		+1	& \text{for right turn} \,.
	\end{cases}\]
	We start at the first word on the Gauss diagram with $t = 1$, and traverse anti-clockwise (set $a = 1$). Each time we encounter another word, we jump via the attached chord, to the other word with the same label. Once we arrive there, we traverse the the Gauss diagram again, with the new alignment given by the update rule
	\[a \leftarrow t \cdot j \cdot w \cdot a\,,\]
	where $t$ is the sign of the turn-direction, the sign of the jump $j$ is given by
	\[j = \begin{cases}
		-1	& \text{if jump $o \to u$}\\
		+1	& \text{if jump $u \to o$}\,,
	\end{cases}\]
	$w$ is the writhe, or sign of the associated crossing.
	
	This continues until we return to the initial word with a direction $a = +1$, as we started with, at which point we increment $f$. For each chord in the Gauss diagram, we maintain a list of the faces, $F_{c}$ that we traversed to visit that chord. We also maintain an array to track which arcs in the Gauss diagram have been visited so far. We continue the process by starting at the next arc yet to be traversed, with the sign of the new turn-direction given by update rule
	\[t \leftarrow -t\,.\]
	Figure \ref{fig:cd_4-106} illustrates the traversal path for $f = 0$ (red) and $f = 1$ (blue).
	
	When the iteration above terminates, each $F_{c}$ will have exactly $2$ elements. We construct the Tait graph with vertex set $V = \{v_{0}, \dots, v_{f}\}$, and edge set $E = \{F_{c} : \text{$c$ a chord}\}$. It is easy to read the Tait graph off Figure \ref{fig:cd_4-106} [Right]; there are two vertices, $v_{0}$ and $v_{1}$, with $2$ loops at $v_{0}$ and two edges $(v_{0}, v_{1})$. 
	
	\notered{Gauss Diagrams}
	
	\notegreen{Insert figure of the Tait graph.}
	
	To find the other Tait graph, we use the same algorithm, but with the opposite initial turn direction ($t = -1$).
	
	\begin{proposition}
		The algorithm given above for finding the Tait graphs from the Gauss code of a knot or virtual knot is correct.
	\end{proposition}
	\begin{proof}
		The first claim is that the inner loop of the algorithm finds the faces in the knot diagram. From the definition of the alignment $a$, we have the association
		\[a = \begin{cases}
			-1 & \text{iff traversing clockwise} \\
			+1 & \text{iff traversing anti-clockwise}\,.
		\end{cases}\]
		Since the direction on the Gauss diagram was induced by the orientation of the knot, $a$ corresponds to whether a traversal of the knot diagram agrees with the orientation. Hence to prove that choosing direction after a crossing jump based on the rule
		\[a \leftarrow t \cdot j \cdot w \cdot a\,,\]
		does in fact lead to the correct choice of $a$ to make a turn in direction $t$ on the knot diagram is simply checking cases. There are $2^{4} = 16$ cases which can easily be checked by drawing all four ways to make a left (resp. right) turn at a negative (resp. positive) crossing. Since we always turn the same direction in our traversal we will indeed find a face of the knot diagram. \notegreen{Insert diagram for one of these cases.}
		
		\notegreen{The second claim is that we will find a face in the knot diagram if and only if it is the same colour as the $f = 0$ face, in the checker-board colouring of the knot diagram.}
		
		\notegreen{The third claim is that the face-finding section of the algorithm terminates and that $|F_{c}| = 2$ at this stage.}
		
		\notegreen{The fourth claim is that the crossings are in bijection with the edges in each Tait graph and that this bijection is given by $c \mapsto F_{c}$.}
		
		This completes the proof. \qedhere
		
	\end{proof}

\section{Mock Seifert Matrix Algorithm}

\begin{proposition}
	The algebraic intersection numbers of the projections of curves into $\Sigma$ is expressible in terms of the linking number of the curves,
	\[p_{*}(\alpha) \cdot p_{*}(\beta) = \dfrac{1}{2}\left(\lk(\tau \alpha, \beta) - \lk(\tau \beta, \alpha)\right)\]
\end{proposition}

This implies the following corollary (which is actually the definition of $\mathcal{G}_{F}$ in \cite{gordon-litherland-pairing-thickened-surfaces}).

\begin{proof}
	\notered{Consider local contributions. Draw similar diagrams to previous proof.}
\end{proof}

\begin{corollary}
The linking form is related to the Gordon-Litherland linking form by
\[\mathcal{L}_{F}(\alpha, \beta) = \mathcal{G}_{F}(\alpha, \beta) + p_{*}(\alpha) \cdot p_{*}(\beta)\]
\end{corollary}

This gives us an easy way to compute the linking form of a given spanning surface. We simply compute the lattice of integer flows of the corresponding Tait graph, then add the intersection numbers of the curve projections.

The following observation of Boden-Karimi \cite[Remark 3.2]{mock-seifert-matrices} makes this computation even easier, and gives us a nice canonical block symmetric form for the computed Mock Seifert matrices -- useful as unimodular congruences are in general a hard task to compute.

\begin{proposition}
	Let $i: F \longrightarrow \Sigma \times I$ be the inclusion map. The restriction of $\mathcal{L}_{F}$ to the subspace $\ker i_{*}$ is symmetric. In fact, if $\alpha \in \ker i_{*}$ or $\beta \in \ker i_{*}$, then $\mathcal{L}_{F}(\alpha, \beta) = \mathcal{L}_{F}(\beta, \alpha)$.
\end{proposition}

\begin{proof}
	Let $a, b$ be representative curves for $\alpha$, $\beta$. Without loss of generality assume $\alpha \in \ker i_{*}$. Then $a$ is null-homotopic in $\Sigma \times I$, so $p(a)$ is null-homotopic in $\Sigma$. Applying the Jordan Curve Theorem on $\Sigma$  shows that $p_{*}(\alpha) \cdot p_{*}(\beta) = 0$. The formula above and the fact that $\mathcal{G}_{F}(\alpha, \beta)$ is symmetric completes the proof.
\end{proof}

This gives us an efficient algorithm to compute the mock Seifert matrix of a knot.

\section{Incompleteness of the Virtual Gordon-Litherland Pairing}

Our counterexamples are given in Fig.~\ref{fig:counterexamples}.

\notered{We use some invariants of unimodular congruence to tell them apart.}

\begin{figure}[H]
	\centering
	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/6-90101_vknot.pdf_tex}
		\caption{Virtual knot $6_{90101}$}
		\label{fig:6-90101_vknot}
	\end{subfigure}
	\hspace*{\fill}	\hspace*{\fill}	\hspace*{\fill}
	\begin{subfigure}[b]{0.4 \textwidth}
		\centering
		\def\svgscale{0.35}
		\input{graphics/6-90124_vknot.pdf_tex}
		\caption{Virtual knot $6_{90124}$}
		\label{fig:6-90124_vknot}
	\end{subfigure}
	\hspace*{\fill} 
	\caption{write}
	\label{fig:counterexamples}
\end{figure}

\section{A Note on Invariants of Unimodular Congruence}

From the tables produced, it was noticed that the Kobayashi invariant \cite{new-invariant-under-congruence}, defined as
\[\kob A = \operatorname{tr}(A^{\top}A^{-1})\]
always satisfied a relation involving the coefficients of the Alexander polynomial
\[\Delta_{A}(t) \coloneq \det(tA - A^{\top})\] \cite{mock-seifert-matrices}.


\begin{proposition}
The Kobayashi invariant satisfies
\[\kob A = -\dfrac{a_{1}}{a_{0}}\]
where $a_{i}$ is the $i$th coefficient of the Alexander polynomial $\Delta_{A}(t)$.
\end{proposition}
\begin{proof}
The matrix $A$, being a mock Seifert matrix, has odd determinant \cite{mock-seifert-matrices} and is therefore invertible. Hence by the multiplicity of determinants,
\[\det(tA - A^{\top}) = \det(A)\det(tI - A^{\top}A^{-1})\,.\]
The last factor here is the characteristic polynomial of $A^{\top}A^{-1}$. It is a well known fact that the zeroth and first coefficients of the characteristic polynomial of $M$, are $\det(M)$ and $-\operatorname{tr}(M)$ respectively. Hence,
\begin{align*}
-\dfrac{a_{1}}{a_{0}}	& = \dfrac{\operatorname{tr}(A^{\top}A^{-1})}{\det(A^{\top}A^{-1})}\,,
\end{align*}
but as $\det(A^{\top}A^{-1}) = \det(A^{\top})\det(A^{-1}) = \det(A)\det(A^{-1}) = 1$, we have
\[-\dfrac{a_{1}}{a_{0}} = \operatorname{tr}(A^{\top}A^{-1})\]
as required.
\end{proof}

This means that the Kobayashi invariant is weaker than the Alexander polynomial.


\newpage
\printbibliography[title=References]


\appendix
\titleformat{\chapter}[block]
  {\normalfont\Large\bfseries}{Appendix \thechapter}{1em}{\Large}
\titlespacing*{\chapter}{0pt}{40pt}{30pt}

\chapter{Table of Alternating Virtual Knots}

\notered{And the matrices corresponding to their $\mathcal{L}_{S}$ and $\mathcal{G}_{S}$ for $S = F$ and $S = F^{*}$, and the invariants we derive from these matrices.}


\end{document}